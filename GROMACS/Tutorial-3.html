<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>3.1. Build CG representations &mdash; SIRAH Force Field v_1.0 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=3060a628"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="../_static/copybutton.js?v=f281be69"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            SIRAH Force Field
          </a>
              <div class="version">
                v_1.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Manual</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../About%20SIRAH.html">About SIRAH</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Citation.html">Citations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Further%20reading.html">Further Reading</a></li>
<li class="toctree-l1"><a class="reference internal" href="../FAQ.html">FAQs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Developers.html">Developers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Tutorials%20amber.html">AMBER</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Tutorials%20gromacs.html">GROMACS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Tutorials%20namd.html">NAMD</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Tutorials%20sirahtools.html">SIRAH tools</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">SIRAH Force Field</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">3.1. Build CG representations</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/GROMACS/Tutorial-3.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <p>This tutorial shows how to use the SIRAH force field to perform a coarse grained (CG) simulation of a
protein in explicit solvent (called WatFour, WT4) in four simple steps: 1 download; 2 map; 3 solvate
and; 4 run. The main references for this tutorial are:  <a class="reference external" href="https://pubs.acs.org/doi/abs/10.1021/ct100379f">WAT4</a>, <a class="reference external" href="https://doi.org/10.1021/acs.jctc.9b00006">SIRAH 2.0</a> and <a class="reference external" href="https://academic.oup.com/bioinformatics/article/32/10/1568/1743152">SIRAH Tools</a>. We strongly advise you to read these articles before starting the tutorial.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Check <a class="reference internal" href="../Tutorials%20gromacs.html#download-gromacs"><span class="std std-ref">download</span></a> section for download and set up details before to start this tutorial.
Since this is <strong>tutorial 3</strong>, remember to replace <code class="docutils literal notranslate"><span class="pre">X.X</span></code>, the files corresponding to this tutorial can be found in: <code class="docutils literal notranslate"><span class="pre">sirah.ff/tutorial/3/</span></code></p>
</div>
<section id="build-cg-representations">
<h1>3.1. Build CG representations<a class="headerlink" href="#build-cg-representations" title="Link to this heading"></a></h1>
<p>Map the protonated atomistic structure of protein 1CRN to its CG representation:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./sirah.ff/tools/CGCONV/cgconv.pl<span class="w"> </span>-i<span class="w"> </span>sirah.ff/tutorial/3/1CRN.pqr<span class="w"> </span>-o<span class="w"> </span>1CRN_cg.pdb
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The mapping to CG requires the correct protonation state of each residue at a given pH. We
recommend using the <a class="reference external" href="https://server.poissonboltzmann.org/pdb2pqr">PDB2PQR server</a> and choosing the output
naming scheme of AMBER for best compatibility. Be aware that modified residues lacking parameters
such as: MSE (seleno MET), TPO (phosphorylated THY), SEP (phosphorylated SER) or others are
deleted from the PQR file by the server. In that case, mutate the residues to their unmodified form
before submitting the structure to the server.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Pay attention to residue names when mapping structures from other atomistic force fields or
experimental structures. Although we provide compatibility for naming schemes in PDB, GMX,
GROMOS, CHARMM and OPLS, there always may be some ambiguity in the residue naming,
specially regarding protonation states, that may lead to a wrong mapping. For example, SIRAH Tools
always maps the residue name “HIS” to a Histidine protonated at Ne regardless the actual proton
placement. Similarly, protonated Glutamic and Aspartic acid residues must be named “GLH” and
“ASH”, otherwise they will be treated as negative charged residues. In addition, protonated and
disulfide bonded Cysteines must be named “CYS” and “CYX” respectively. These kind of situations
need to be carefully checked by the users. In all cases the residues preserve their identity when
mapping and back-mapping the structures. Hence, the total charge of the protein should be the same
at atomistic and SIRAH level. You can check the following mapping file to be sure of the compatibility:<code class="docutils literal notranslate"><span class="pre">sirah.ff/tools/CGCONV/maps/sirah_prot.map</span></code>.</p>
</div>
<p>The input file 1CRN.pqr contains all the heavy atoms composing the protein, while the output
1CRN_cg.pdb preserves a few of them. Please check both PDB and PQR structures using VMD:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>vmd<span class="w"> </span>-m<span class="w"> </span>sirah.ff/tutorial/3/1CRN.pqr<span class="w"> </span>1CRN_cg.pdb
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>This is the basic usage of the script <strong>cgconv.pl</strong>, you can learn other capabilities from its help:
<code class="docutils literal notranslate"><span class="pre">./sirah.amber/tools/CGCONV/cgconv.pl</span> <span class="pre">-h</span></code></p>
</div>
<p>From now on it is just normal GROMACS stuff!</p>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>In GROMACS versions prior to 5.x, the “gmx” command should not be used.</p>
</div>
</section>
<section id="pdb-to-gromacs-format">
<h1>3.2. PDB to GROMACS format<a class="headerlink" href="#pdb-to-gromacs-format" title="Link to this heading"></a></h1>
<p>Use pdb2gmx to convert your PDB file into GROMACS format:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gmx<span class="w"> </span>pdb2gmx<span class="w"> </span>-f<span class="w"> </span>1CRN_cg.pdb<span class="w"> </span>-o<span class="w"> </span>1CRN_cg.gro
</pre></div>
</div>
<p>When prompted, choose <strong>SIRAH force field</strong> and then <strong>SIRAH solvent models</strong>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>By default charged terminal are used but it is possible to set them neutral with option <code class="docutils literal notranslate"><span class="pre">-ter</span></code></p>
</div>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>Getting warning messages of long bonds is fine and expected due to the CG nature of the
residue topologies. However missing atom messages are errors which probably trace back to the
mapping step. In that case, check your atomistic and mapped structures and do not carry on the
simulation until the problem is solved.</p>
</div>
</section>
<section id="solvate-the-system">
<h1>3.3. Solvate the system<a class="headerlink" href="#solvate-the-system" title="Link to this heading"></a></h1>
<p>Define the simulation box of the system</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gmx<span class="w"> </span>editconf<span class="w"> </span>-f<span class="w"> </span>1CRN_cg.gro<span class="w"> </span>-o<span class="w"> </span>1CRN_cg_box.gro<span class="w"> </span>-bt<span class="w"> </span>octahedron<span class="w"> </span>-d<span class="w"> </span><span class="m">2</span>.0<span class="w"> </span>-c
</pre></div>
</div>
<p>Add WT4 molecules:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gmx<span class="w"> </span>solvate<span class="w"> </span>-cp<span class="w"> </span>1CRN_cg_box.gro<span class="w"> </span>-cs<span class="w"> </span>sirah.ff/wt416.gro<span class="w"> </span>-o<span class="w"> </span>1CRN_cg_sol1.gro
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In GROMACS in versions earlier than 5.x the command  <em>gmx solvate</em> was named to <em>genbox</em>.</p>
</div>
<p>Edit the [ molecules ] section in topol.top to include the number of added WT4 molecules:</p>
<table class="docutils align-center">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Topology before editing</p></th>
<th class="head"><p>Topology after editing</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><div class="line-block">
<div class="line">[ molecules ]</div>
<div class="line">; Compound #mols</div>
<div class="line">Protein_chain_A 1</div>
<div class="line"><br /></div>
</div>
</td>
<td><div class="line-block">
<div class="line">[ molecules ]</div>
<div class="line">; Compound #mols</div>
<div class="line">Protein_chain_A 1</div>
<div class="line">WT4 756</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>If you forget to read the number of added WT4 molecules from the output of <em>solvate</em>, then use the following command line to get it</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">grep -c WP1 1CRN_cg_sol1.gro</span>
</pre></div>
</div>
</div>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>The number of added WT4 molecules, <strong>756</strong>, may change according to the software version.</p>
</div>
<p>Remove WT4 molecules within 0.3 nm of protein:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">echo</span><span class="w"> </span>q<span class="w"> </span><span class="p">|</span><span class="w"> </span>gmx<span class="w"> </span>make_ndx<span class="w"> </span>-f<span class="w"> </span>1CRN_cg_sol1.gro<span class="w"> </span>-o<span class="w"> </span>1CRN_cg_sol1.ndx
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gmx<span class="w"> </span>grompp<span class="w"> </span>-f<span class="w"> </span>sirah.ff/tutorial/3/CPU/em1_CGPROT.mdp<span class="w"> </span>-p<span class="w"> </span>topol.top<span class="w"> </span>-po<span class="w"> </span>delete1.mdp<span class="w"> </span>-c<span class="w"> </span>1CRN_cg_sol1.gro<span class="w"> </span>-o<span class="w"> </span>1CRN_cg_sol1.tpr
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gmx<span class="w"> </span><span class="k">select</span><span class="w"> </span>-f<span class="w"> </span>1CRN_cg_sol1.gro<span class="w"> </span>-s<span class="w"> </span>1CRN_cg_sol1.tpr<span class="w"> </span>-n<span class="w"> </span>1CRN_cg_sol1.ndx<span class="w"> </span>-on<span class="w"> </span>rm_close_wt4.ndx<span class="w"> </span>-select<span class="w"> </span><span class="s1">&#39;not (same residue as (resname WT4 and within 0.3 of group Protein))&#39;</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gmx<span class="w"> </span>editconf<span class="w"> </span>-f<span class="w"> </span>1CRN_cg_sol1.gro<span class="w"> </span>-o<span class="w"> </span>1CRN_cg_sol2.gro<span class="w"> </span>-n<span class="w"> </span>rm_close_wt4.ndx
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In GROMACS in versions earlier than 5.x the command <em>gmx select</em> was named <em>g_select</em>.</p>
</div>
<p>Edit the [ molecules ] section in topol.top to include the correct number of WT4 molecules:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>grep<span class="w"> </span>-c<span class="w"> </span>WP1<span class="w"> </span>1CRN_cg_sol2.gro
</pre></div>
</div>
<p>Add CG counterions and 0.15M NaCl:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gmx<span class="w"> </span>grompp<span class="w"> </span>-f<span class="w"> </span>sirah.ff/tutorial/3/CPU/em1_CGPROT.mdp<span class="w"> </span>-p<span class="w"> </span>topol.top<span class="w"> </span>-po<span class="w"> </span>delete2.mdp<span class="w"> </span>-c<span class="w"> </span>1CRN_cg_sol2.gro<span class="w"> </span>-o<span class="w"> </span>1CRN_cg_sol2.tpr
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gmx<span class="w"> </span>genion<span class="w"> </span>-s<span class="w"> </span>1CRN_cg_sol2.tpr<span class="w"> </span>-o<span class="w"> </span>1CRN_cg_ion.gro<span class="w"> </span>-np<span class="w"> </span><span class="m">22</span><span class="w"> </span>-pname<span class="w"> </span>NaW<span class="w"> </span>-nn<span class="w"> </span><span class="m">22</span><span class="w"> </span>-nname<span class="w"> </span>ClW
</pre></div>
</div>
<p>When prompted, choose to substitute <strong>WT4</strong> molecules by <strong>ions</strong>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The available ionic species in SIRAH force field are: <code class="docutils literal notranslate"><span class="pre">Na⁺</span></code> (NaW), <code class="docutils literal notranslate"><span class="pre">K⁺</span></code> (KW) and <code class="docutils literal notranslate"><span class="pre">Cl⁻</span></code> (ClW). One
ion pair (e.g. NaW-ClW) each 34 WT4 molecules renders a salt concentration of ~0.15M (see <a class="reference internal" href="../Tutorials%20amber.html#appendix"><span class="std std-ref">Appendix</span></a> for details).
Counterions were added according to <a class="reference external" href="https://pubs.acs.org/doi/10.1021/acs.jctc.9b00953">Machado et al.</a>.</p>
</div>
<p>Edit the [ molecules ] section in <code class="docutils literal notranslate"><span class="pre">topol.top</span></code> to include the CG ions and the correct number of WT4.</p>
<p>Before running the simulation it may be a good idea to visualize your molecular system. CG molecules
are not recognized by molecular visualizers and will not display correctly. To fix this problem you may
generate a PSF file of the system using the script <em>g_top2psf.pl</em>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./sirah.ff/tools/g_top2psf.pl<span class="w"> </span>-i<span class="w"> </span>topol.top<span class="w"> </span>-o<span class="w"> </span>1CRN_cg_ion.psf
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is the basic usage of the script <code class="docutils literal notranslate"><span class="pre">g_top2psf.pl</span></code>, you can learn other capabilities from its help:
<code class="docutils literal notranslate"><span class="pre">./sirah.ff/tools/g_top2psf.pl</span> <span class="pre">-h</span></code></p>
</div>
<p>Use VMD to check how the CG system looks like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">vmd</span> <span class="mi">1</span><span class="n">CRN_cg_ion</span><span class="o">.</span><span class="n">psf</span> <span class="mi">1</span><span class="n">CRN_cg_ion</span><span class="o">.</span><span class="n">gro</span> <span class="o">-</span><span class="n">e</span> <span class="n">sirah</span><span class="o">.</span><span class="n">ff</span><span class="o">/</span><span class="n">tools</span><span class="o">/</span><span class="n">sirah_vmdtk</span><span class="o">.</span><span class="n">tcl</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>VMD assigns default radius to unknown atom types, the script sirah_vmdtk.tcl sets the right
ones. It also provides a kit of useful selection macros, coloring methods and a backmapping utility.
Use the command sirah_help in the Tcl/Tk console of VMD to access the manual pages.</p>
</div>
<p>Create an index file including a group for the backbone GN and GO beads:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;a GN GO\n\nq&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>gmx<span class="w"> </span>make_ndx<span class="w"> </span>-f<span class="w"> </span>1CRN_cg_ion.gro<span class="w"> </span>-o<span class="w"> </span>1CRN_cg_ion.ndx
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>WT4 and CG ions (NaW, ClW) are automatically set to the group <strong>SIRAH-Solvent</strong>.</p>
</div>
<p>Generate restraint files for the backbone GN and GO beads:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gmx<span class="w"> </span>genrestr<span class="w"> </span>-f<span class="w"> </span>1CRN_cg.gro<span class="w"> </span>-n<span class="w"> </span>1CRN_cg_ion.ndx<span class="w"> </span>-o<span class="w"> </span>bkbres.itp
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gmx<span class="w"> </span>genrestr<span class="w"> </span>-f<span class="w"> </span>1CRN_cg.gro<span class="w"> </span>-n<span class="w"> </span>1CRN_cg_ion.ndx<span class="w"> </span>-o<span class="w"> </span>bkbres_soft.itp<span class="w"> </span>-fc<span class="w"> </span><span class="m">100</span><span class="w"> </span><span class="m">100</span><span class="w"> </span><span class="m">100</span>
</pre></div>
</div>
<p>When prompted, choose the group <strong>GN_GO</strong></p>
<p>Add restraints to topol.top</p>
<table class="docutils align-center" id="id2">
<caption><span class="caption-text">restraints to topol.top</span><a class="headerlink" href="#id2" title="Link to this table"></a></caption>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Topology before editing</p></th>
<th class="head"><p>Topology after editing</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><div class="line-block">
<div class="line">; Include Position restraint file</div>
<div class="line">#ifdef POSRES</div>
<div class="line">#include “posre.itp”</div>
<div class="line">#endif</div>
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
</td>
<td><div class="line-block">
<div class="line">; Include Position restraint file</div>
<div class="line">#ifdef POSRES</div>
<div class="line">#include “posre.itp”</div>
<div class="line">#endif</div>
</div>
<div class="line-block">
<div class="line">; Backbone restraints
| #ifdef GN_GO</div>
<div class="line">#include “bkbres.itp”</div>
<div class="line">#endif</div>
</div>
<div class="line-block">
<div class="line">; Backbone soft restrains
| #ifdef GN_GO_SOFT</div>
<div class="line">#include “bkbres_soft.itp”</div>
<div class="line">#endif</div>
</div>
</td>
</tr>
</tbody>
</table>
</section>
<section id="run-the-simulation">
<h1>3.4. Run the simulation<a class="headerlink" href="#run-the-simulation" title="Link to this heading"></a></h1>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>By default in this tutorial we will use input files for GROMACS on GPU (<code class="docutils literal notranslate"><span class="pre">sirah.ff/tutorial/3/GPU</span></code>). Example input files for using GROMACS on CPU can be found at: <code class="docutils literal notranslate"><span class="pre">sirah.ff/tutorial/3/CPU</span></code>.</p>
</div>
<p>The folder <code class="docutils literal notranslate"><span class="pre">sirah.ff/tutorial/3/GPU/</span></code> contains typical input files for energy minimization
(<code class="docutils literal notranslate"><span class="pre">em1_CGPROT.mdp</span></code>, <code class="docutils literal notranslate"><span class="pre">em2_CGPROT.mdp</span></code>), equilibration (<code class="docutils literal notranslate"><span class="pre">eq1_CGPROT.mdp</span></code>, <code class="docutils literal notranslate"><span class="pre">eq2_CGPROT.mdp</span></code>)
and production (<code class="docutils literal notranslate"><span class="pre">md_CGPROT.mdp</span></code>) runs. Please check carefully the input flags therein.</p>
<p>Make a new folder for the run:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mkdir<span class="w"> </span>-p<span class="w"> </span>run<span class="p">;</span><span class="w"> </span><span class="nb">cd</span><span class="w"> </span>run
</pre></div>
</div>
<p><strong>Energy Minimization of side chains by restraining the backbone:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gmx<span class="w"> </span>grompp<span class="w"> </span>-f<span class="w"> </span>../sirah.ff/tutorial/3/CPU/em1_CGPROT.mdp<span class="w"> </span>-p<span class="w"> </span>../topol.top<span class="w"> </span>-po<span class="w"> </span>em1.mdp<span class="w"> </span>-n<span class="w"> </span>../1CRN_cg_ion.ndx<span class="w"> </span>-c<span class="w"> </span>../1CRN_cg_ion.gro<span class="w"> </span>-r<span class="w"> </span>../1CRN_cg_ion.gro<span class="w"> </span>-o<span class="w"> </span>1CRN_cg_em1.tpr
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gmx<span class="w"> </span>mdrun<span class="w"> </span>-deffnm<span class="w"> </span>1CRN_cg_em1<span class="w"> </span><span class="p">&amp;</span>&gt;<span class="w"> </span>EM1.log<span class="w"> </span><span class="p">&amp;</span>
</pre></div>
</div>
<p><strong>Energy Minimization of whole system:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gmx<span class="w"> </span>grompp<span class="w"> </span>-f<span class="w"> </span>../sirah.ff/tutorial/3/CPU/em2_CGPROT.mdp<span class="w"> </span>-p<span class="w"> </span>../topol.top<span class="w"> </span>-po<span class="w"> </span>em2.mdp<span class="w"> </span>-n<span class="w"> </span>../1CRN_cg_ion.ndx<span class="w"> </span>-c<span class="w"> </span>1CRN_cg_em1.gro<span class="w"> </span>-o<span class="w"> </span>1CRN_cg_em2.tpr
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gmx<span class="w"> </span>mdrun<span class="w"> </span>-deffnm<span class="w"> </span>1CRN_cg_em2<span class="w"> </span><span class="p">&amp;</span>&gt;<span class="w"> </span>EM2.log<span class="w"> </span><span class="p">&amp;</span>
</pre></div>
</div>
<p><strong>Solvent equilibration:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gmx<span class="w"> </span>grompp<span class="w"> </span>-f<span class="w"> </span>../sirah.ff/tutorial/3/CPU/eq1_CGPROT.mdp<span class="w"> </span>-p<span class="w"> </span>../topol.top<span class="w"> </span>-po<span class="w"> </span>eq1.mdp<span class="w"> </span>-n<span class="w"> </span>./1CRN_cg_ion.ndx<span class="w"> </span>-c<span class="w"> </span>1CRN_cg_em2.gro<span class="w"> </span>-r<span class="w"> </span>1CRN_cg_em2.gro<span class="w"> </span>-o<span class="w"> </span>1CRN_cg_eq1.tpr
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gmx<span class="w"> </span>mdrun<span class="w"> </span>-deffnm<span class="w"> </span>1CRN_cg_eq1<span class="w"> </span><span class="p">&amp;</span>&gt;<span class="w"> </span>EQ1.log<span class="w"> </span><span class="p">&amp;</span>
</pre></div>
</div>
<p><strong>Soft equilibration to improve side chain solvation:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gmx<span class="w"> </span>grompp<span class="w"> </span>-f<span class="w"> </span>../sirah.ff/tutorial/3/CPU/eq2_CGPROT.mdp<span class="w"> </span>-p<span class="w"> </span>../topol.top<span class="w"> </span>-po<span class="w"> </span>eq2.mdp<span class="w"> </span>-n<span class="w"> </span>../1CRN_cg_ion.ndx<span class="w"> </span>-c<span class="w"> </span>1CRN_cg_eq1.gro<span class="w"> </span>-r<span class="w"> </span>1CRN_cg_eq1.gro<span class="w"> </span>-o<span class="w"> </span>1CRN_cg_eq2.tpr
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gmx<span class="w"> </span>mdrun<span class="w"> </span>-deffnm<span class="w"> </span>1CRN_cg_eq2<span class="w"> </span><span class="p">&amp;</span>&gt;<span class="w"> </span>EQ2.log<span class="w"> </span><span class="p">&amp;</span>
</pre></div>
</div>
<p><strong>Production</strong> (1 <span class="math notranslate nohighlight">\(\mu s\)</span>):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gmx<span class="w"> </span>grompp<span class="w"> </span>-f<span class="w"> </span>../sirah.ff/tutorial/3/CPU/md_CGPROT.mdp<span class="w"> </span>-p<span class="w"> </span>../topol.top<span class="w"> </span>-po<span class="w"> </span>md.mdp<span class="w"> </span>-n<span class="w"> </span>../1CRN_cg_ion.ndx<span class="w"> </span>-c<span class="w"> </span>1CRN_cg_eq2.gro<span class="w"> </span>-o<span class="w"> </span>1CRN_cg_md.tpr
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gmx<span class="w"> </span>mdrun<span class="w"> </span>-deffnm<span class="w"> </span>1CRN_cg_md<span class="w"> </span><span class="p">&amp;</span>&gt;<span class="w"> </span>MD.log<span class="w"> </span><span class="p">&amp;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>GPU flags were set for GROMACS 4.6.7, different versions may complain about some specifications.</p>
</div>
</section>
<section id="visualizing-the-simulation">
<h1>3.5. Visualizing the simulation<a class="headerlink" href="#visualizing-the-simulation" title="Link to this heading"></a></h1>
<p>That’s it! Now you can analyze the trajectory.</p>
<p>Process the output trajectory at folder run/ to account for the Periodic Boundary Conditions (PBC):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gmx<span class="w"> </span>trjconv<span class="w"> </span>-s<span class="w"> </span>1CRN_cg_em1.tpr<span class="w"> </span>-f<span class="w"> </span>1CRN_cg_md.xtc<span class="w"> </span>-o<span class="w"> </span>1CRN_cg_md_pbc.xtc<span class="w"> </span>-n<span class="w"> </span>../1CRN_cg_ion.ndx<span class="w"> </span>-ur<span class="w"> </span>compact<span class="w"> </span>-center<span class="w"> </span>-pbc<span class="w"> </span>mol
</pre></div>
</div>
<p>When prompted, choose <strong>Protein</strong> for centering and <strong>System</strong> for output.</p>
<p>Now you can check the simulation using VMD:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>vmd<span class="w"> </span>../1CRN_cg_ion.psf<span class="w"> </span>../1CRN_cg_ion.gro<span class="w"> </span>1CRN_cg_md_pbc.xtc<span class="w"> </span>-e<span class="w"> </span>../sirah.ff/tools/sirah_vmdtk.tcl
</pre></div>
</div>
</section>
<section id="calculate-the-solvent-accessible-surface-sas">
<h1>3.6. Calculate the solvent accessible surface (SAS)<a class="headerlink" href="#calculate-the-solvent-accessible-surface-sas" title="Link to this heading"></a></h1>
<p>Create the following symbolic link in the folder run/:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ln<span class="w"> </span>-s<span class="w"> </span>../sirah.ff/vdwradii.dat
</pre></div>
</div>
<p>Calculate the SAS of the protein along the trajectory:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>g_sas<span class="w"> </span>-s<span class="w"> </span>1CRN_cg_md.tpr<span class="w"> </span>-f<span class="w"> </span>1CRN_cg_md_pbc.xtc<span class="w"> </span>-n<span class="w"> </span>../1CRN_cg_ion.ndx<span class="w"> </span>-qmax<span class="w"> </span><span class="m">0</span><span class="w"> </span>-probe<span class="w"> </span><span class="m">0</span>.21<span class="w"> </span>-o<span class="w"> </span>area.xvg
</pre></div>
</div>
<p>When prompted, choose <strong>Protein</strong> as both the group for calculation and the output.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The solvent probe radius corresponds to a WT4 bead while a charge of 0e refers to any
hydrophobic bead. The file vdwradii.dat must be placed at the same folder where <em>gmx sasa</em> is executed to       assure that the correct van der Waals radii of SIRAH beads are used in the calculation.</p>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>g_sas is deprecated, the tool no longer automatically divides the surface into hydrophobic and hydrophilic areas, and there is no -f_index option. The same effects can be obtained by defining suitable selections for -output. If you want output that contains the same numbers as with the old tool for a calculation group A and output group B, you can use <a class="reference external" href="https://manual.gromacs.org/current/user-guide/cmdline.html">[1]</a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gmx</span> <span class="n">sasa</span> <span class="o">-</span><span class="n">surface</span> <span class="s1">&#39;group &quot;A&quot;&#39;</span> <span class="o">-</span><span class="n">output</span> <span class="s1">&#39;&quot;Hydrophobic&quot; group &quot;A&quot; and charge {-0.2 to 0.2}; &quot;Hydrophilic&quot; group &quot;B&quot; and not charge {-0.2 to 0.2}; &quot;Total&quot; group &quot;B&quot;&#39;</span>
</pre></div>
</div>
</div>
<p>You can use Grace to plot the results:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">xmgrace</span> <span class="o">-</span><span class="n">nxy</span> <span class="n">area</span><span class="o">.</span><span class="n">xvg</span>
</pre></div>
</div>
</section>
<section id="visualize-the-secondary-structure">
<h1>3.7. Visualize the secondary structure<a class="headerlink" href="#visualize-the-secondary-structure" title="Link to this heading"></a></h1>
<p>Load the processed trajectory in VMD:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">vmd</span> <span class="o">../</span><span class="mi">1</span><span class="n">CRN_cg_ion</span><span class="o">.</span><span class="n">psf</span> <span class="o">../</span><span class="mi">1</span><span class="n">CRN_cg_ion</span><span class="o">.</span><span class="n">gro</span> <span class="mi">1</span><span class="n">CRN_cg_md_pbc</span><span class="o">.</span><span class="n">xtc</span> <span class="o">-</span><span class="n">e</span> <span class="o">../</span><span class="n">sirah</span><span class="o">.</span><span class="n">ff</span><span class="o">/</span><span class="n">tools</span><span class="o">/</span><span class="n">sirah_vmdtk</span><span class="o">.</span><span class="n">tcl</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The file <code class="docutils literal notranslate"><span class="pre">sirah_vmdtk.tcl</span></code> is a Tcl script that is part of SIRAH Tools and contains the macros to properly visualize the coarse-grained structures in VMD. Use the command <code class="docutils literal notranslate"><span class="pre">sirah-help</span></code> in the Tcl/Tk console of VMD to access the manual pages.</p>
</div>
<p>At the <strong>Tk/Tcl console</strong> run the command <code class="docutils literal notranslate"><span class="pre">sirah_ss</span></code> to get the secondary structure of the CG protein.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>After assigning the secondary structure it is possible to represent a-helices with Bendix in VMD
1.9.2 or upper by setting the backbone particle name to GC (do not check the CG box).</p>
</div>
<p>To analyze the output files from sirah_ss, go back at the shell command line and execute:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">xmgrace</span> <span class="o">-</span><span class="n">nxy</span> <span class="n">ss_by_frame</span><span class="o">.</span><span class="n">xvg</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>xmgrace<span class="w"> </span>-nxy<span class="w"> </span>ss_by_res.xvg
</pre></div>
</div>
<p>The file ss.mtx can be processed to visualize the time evolution of the secondary structure by residue:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">../</span><span class="n">sirah</span><span class="o">.</span><span class="n">ff</span><span class="o">/</span><span class="n">tools</span><span class="o">/</span><span class="n">ssmtx2png</span><span class="o">.</span><span class="n">R</span> <span class="o">--</span><span class="n">mtx</span><span class="o">=</span><span class="n">ss</span><span class="o">.</span><span class="n">mtx</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>display<span class="w"> </span>ssmtx.png
</pre></div>
</div>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>The usage of ssmtx2png.R can be accessed through:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">../</span><span class="n">sirah</span><span class="o">.</span><span class="n">ff</span><span class="o">/</span><span class="n">tools</span><span class="o">/</span><span class="n">ssmtx2png</span><span class="o">.</span><span class="n">R</span> <span class="o">--</span><span class="n">help</span>
</pre></div>
</div>
</div>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, BA, SL, SM.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>
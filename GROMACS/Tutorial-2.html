<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>2.1. PDB to GROMACS format &mdash; SIRAH Force Field v_1.0 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=3060a628"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            SIRAH Force Field
          </a>
              <div class="version">
                v_1.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Manual</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../About%20SIRAH.html">About SIRAH</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Citation.html">Citations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Further%20reading.html">Further Reading</a></li>
<li class="toctree-l1"><a class="reference internal" href="../FAQ.html">FAQs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Developers.html">Developers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Tutorials%20amber.html">AMBER</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Tutorials%20gromacs.html">GROMACS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Tutorials%20namd.html">NAMD</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Tutorials%20sirahtools.html">SIRAH tools</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">SIRAH Force Field</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">2.1. PDB to GROMACS format</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/GROMACS/Tutorial-2.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <p>This tutorial shows how to apply the hybrid solvation approach of SIRAH force field to speed up the simulation of an atomistic solute. The example system contains a DNA fiber surrounded by a shell of atomistic waters, which are embedded in coarse-grained (CG) molecules, called WT4, to represent
bulk water. The general procedure is extensible to any other solute. The hybrid solvation methodology is well tested for SPC, SPC/E, TIP3P atomistic water models. The main references for this tutorial are: <a class="reference external" href="https://pubs.acs.org/doi/abs/10.1021/ct100379f">WAT4</a>, <a class="reference external" href="https://pubs.acs.org/doi/abs/10.1021/ct3001816">All-atoms/CG solvation</a>, <cite>Transferable All-atoms/CG solvation &lt;https://pubs.acs.org/doi/abs/10.1021/jp4079579&gt;</cite>, and <a class="reference external" href="https://academic.oup.com/bioinformatics/article/32/10/1568/1743152">SIRAH Tools</a>. We strongly advise you to read these articles before starting the tutorial.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Check <a class="reference internal" href="../Tutorials%20gromacs.html#download-gromacs"><span class="std std-ref">download</span></a> section for download and set up details before to start this tutorial.
Since this is <strong>tutorial 2</strong>, remember to replace <code class="docutils literal notranslate"><span class="pre">X.X</span></code>, the files corresponding to this tutorial can be found in: <code class="docutils literal notranslate"><span class="pre">sirah.ff/tutorial/2/</span></code></p>
</div>
<section id="pdb-to-gromacs-format">
<h1>2.1. PDB to GROMACS format<a class="headerlink" href="#pdb-to-gromacs-format" title="Link to this heading"></a></h1>
<p>Use pdb2gmx to convert the PDB file of the solute <code class="docutils literal notranslate"><span class="pre">dna.pdb</span></code> into GROMACS format:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gmx<span class="w"> </span>pdb2gmx<span class="w"> </span>-f<span class="w"> </span>sirah.ff/tutorial/2/dna.pdb<span class="w"> </span>-o<span class="w"> </span>dna.gro
</pre></div>
</div>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>In GROMACS versions prior to 5.x, the “gmx” command should not be used.</p>
</div>
<p>When prompted, choose <em>AMBER99SB</em> and then <em>TIP3P</em> as water model.</p>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>Getting warning messages of long bonds is fine and expected due to the CG nature of the
residue topologies. However missing atom messages are errors which probably trace back to the
mapping step. In that case, check your atomistic and mapped structures and do not carry on the
simulation until the problem is solved.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Merging both DNA chains is convenient when planning to apply restraints between them.</p>
</div>
<p>During long simulations of DNA, capping residues may eventually separate. If you want to avoid this
effect, which is called helix fraying, add Watson-Crick (WC) restraints at terminal base pairs. To add
these restraints edit <code class="docutils literal notranslate"><span class="pre">topol.top</span></code> to include the file <code class="docutils literal notranslate"><span class="pre">WC_RST.itp</span></code> at the end of the [ moleculetype ] section:</p>
<table class="docutils align-center">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Topology without WC restraints</p></th>
<th class="head"><p>Topology with WC restraints</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><div class="line-block">
<div class="line">; Include Position restraint file</div>
<div class="line">#ifdef POSRES</div>
<div class="line">#include “posre.itp”</div>
<div class="line">#endif</div>
</div>
</td>
<td><div class="line-block">
<div class="line">; Include Position restraint file</div>
<div class="line">#ifdef POSRES</div>
<div class="line">#include “posre.itp”</div>
<div class="line">#endif</div>
<div class="line">; Watson-Crick restraints</div>
<div class="line">#include “./sirah.ff/tutorial/1/WC_RST.itp”</div>
</div>
</td>
</tr>
</tbody>
</table>
</section>
<section id="solvate-the-system">
<h1>1.3. Solvate the system<a class="headerlink" href="#solvate-the-system" title="Link to this heading"></a></h1>
<p>Define the simulation box of the system</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gmx<span class="w"> </span>editconf<span class="w"> </span>-f<span class="w"> </span>dna_cg.gro<span class="w"> </span>-o<span class="w"> </span>dna_cg_box.gro<span class="w"> </span>-bt<span class="w"> </span>octahedron<span class="w"> </span>-d<span class="w"> </span><span class="m">2</span><span class="w"> </span>-c
</pre></div>
</div>
<p>Add WT4 molecules:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gmx<span class="w"> </span>solvate<span class="w"> </span>-cp<span class="w"> </span>dna_cg_box.gro<span class="w"> </span>-cs<span class="w"> </span>sirah.ff/wt416.gro<span class="w"> </span>-o<span class="w"> </span>dna_cg_sol.gro
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In GROMACS in versions earlier than 5.x the command  <em>gmx solvate</em> was named to <em>genbox</em>.</p>
</div>
<p>Edit the [ molecules ] section in <code class="docutils literal notranslate"><span class="pre">topol.top</span></code> to include the number of added WT4 molecules:</p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>If you forget to read the number of added WT4 molecules from the output of <em>solvate</em>, then use the following command line to get it</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">grep -c WP1 dna_cg_sol.gro</span>
</pre></div>
</div>
</div>
<table class="docutils align-center">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Topology before editing</p></th>
<th class="head"><p>Topology after editing</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><div class="line-block">
<div class="line">[ molecules ]</div>
<div class="line">; Compound #mols</div>
<div class="line">DNA_chain_A 1</div>
</div>
</td>
<td><div class="line-block">
<div class="line">[ molecules ]</div>
<div class="line">; Compound #mols</div>
<div class="line">DNA_chain_A 1</div>
<div class="line">WT4 3179</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>The number of added WT4 molecules <strong>3179</strong> may change according to the software version.</p>
</div>
<p>Add CG counterions and 0.15M NaCl:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gmx<span class="w"> </span>grompp<span class="w"> </span>-f<span class="w"> </span>sirah.ff/tutorial/1/CPU/em_CGDNA.mdp<span class="w"> </span>-p<span class="w"> </span>topol.top<span class="w"> </span>-c<span class="w"> </span>dna_cg_sol.gro<span class="w"> </span>-o<span class="w"> </span>dna_cg_sol.tpr
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gmx<span class="w"> </span>genion<span class="w"> </span>-s<span class="w"> </span>dna_cg_sol.tpr<span class="w"> </span>-o<span class="w"> </span>dna_cg_ion.gro<span class="w"> </span>-np<span class="w"> </span><span class="m">113</span><span class="w"> </span>-pname<span class="w"> </span>NaW<span class="w"> </span>-nn<span class="w"> </span><span class="m">75</span><span class="w"> </span>-nname<span class="w"> </span>ClW
</pre></div>
</div>
<p>When prompted, choose to substitute WT4 molecules by ions.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The available ionic species in SIRAH force field are: <code class="docutils literal notranslate"><span class="pre">Na⁺</span></code> (NaW), <code class="docutils literal notranslate"><span class="pre">K⁺</span></code> (KW) and <code class="docutils literal notranslate"><span class="pre">Cl⁻</span></code> (ClW). One
ion pair (e.g. NaW-ClW) each 34 WT4 molecules renders a salt concentration of ~0.15M (see <a class="reference internal" href="../Tutorials%20amber.html#appendix"><span class="std std-ref">Appendix</span></a> for details).
Counterions were added according to <a class="reference external" href="https://pubs.acs.org/doi/10.1021/acs.jctc.9b00953">Machado et al.</a>.</p>
</div>
<p>Edit the [ molecules ] section in <code class="docutils literal notranslate"><span class="pre">topol.top</span></code> to include the CG ions and the correct number of WT4.</p>
<p>Before running the simulation it may be a good idea to visualize your molecular system. CG molecules
are not recognized by molecular visualizers and will not display correctly. To fix this problem you may
generate a PSF file of the system using the script <em>g_top2psf.pl</em>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./sirah.ff/tools/g_top2psf.pl<span class="w"> </span>-i<span class="w"> </span>topol.top<span class="w"> </span>-o<span class="w"> </span>dna_cg_ion.psf
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is the basic usage of the script <code class="docutils literal notranslate"><span class="pre">g_top2psf.pl</span></code>, you can learn other capabilities from its help:
<code class="docutils literal notranslate"><span class="pre">./sirah.ff/tools/g_top2psf.pl</span> <span class="pre">-h</span></code></p>
</div>
<p>Use VMD to check how the CG system looks like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">vmd</span> <span class="n">dna_cg_ion</span><span class="o">.</span><span class="n">psf</span> <span class="n">dna_cg_ion</span><span class="o">.</span><span class="n">gro</span> <span class="o">-</span><span class="n">e</span> <span class="n">sirah</span><span class="o">.</span><span class="n">ff</span><span class="o">/</span><span class="n">tools</span><span class="o">/</span><span class="n">sirah_vmdtk</span><span class="o">.</span><span class="n">tcl</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>VMD assigns default radius to unknown atom types, the script sirah_vmdtk.tcl sets the right
ones. It also provides a kit of useful selection macros, coloring methods and a backmapping utility.
Use the command sirah_help in the Tcl/Tk console of VMD to access the manual pages.</p>
</div>
</section>
<section id="run-the-simulation">
<h1>1.4. Run the simulation<a class="headerlink" href="#run-the-simulation" title="Link to this heading"></a></h1>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>By default in this tutorial we will use input files for GROMACS on GPU (<code class="docutils literal notranslate"><span class="pre">sirah.ff/tutorial/1/GPU</span></code>). Example input files for using GROMACS on CPU can be found at: <code class="docutils literal notranslate"><span class="pre">sirah.ff/tutorial/1/CPU</span></code>.</p>
</div>
<p>The folder <code class="docutils literal notranslate"><span class="pre">sirah.ff/tutorial/1/GPU/</span></code> contains typical input files for energy minimization
(<code class="docutils literal notranslate"><span class="pre">em_CGDNA.mdp</span></code>), equilibration (<code class="docutils literal notranslate"><span class="pre">eq_CGDNA.mdp</span></code>) and production (<code class="docutils literal notranslate"><span class="pre">md_CGDNA.mdp</span></code>) runs. Please
check carefully the input flags therein.</p>
<p>Create an index file:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;q&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>make_ndx<span class="w"> </span>-f<span class="w"> </span>dna_cg_ion.gro<span class="w"> </span>-o<span class="w"> </span>dna_cg_ion.ndx
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>WT4 and CG ions (NaW and ClW) are automatically set to the group “SIRAH-Solvent”.</p>
</div>
<p>Make a new folder for the run:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mkdir<span class="w"> </span>run<span class="p">;</span><span class="w"> </span><span class="nb">cd</span><span class="w"> </span>run
</pre></div>
</div>
<p>Energy Minimization:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gmx<span class="w"> </span>grompp<span class="w"> </span>-f<span class="w"> </span>../sirah.ff/tutorial/1/GPU/em_CGDNA.mdp<span class="w"> </span>-p<span class="w"> </span>../topol.top<span class="w"> </span>-po<span class="w"> </span>em.mdp<span class="w"> </span>-n<span class="w"> </span>../dna_cg_ion.ndx<span class="w"> </span>-c<span class="w"> </span>../dna_cg_ion.gro<span class="w"> </span>-o<span class="w"> </span>dna_cg_em.tpr<span class="w"> </span>mdrun<span class="w"> </span>-deffnm<span class="w"> </span>dna_cg_em<span class="w"> </span><span class="p">&amp;</span>&gt;<span class="w"> </span>EM.log<span class="w"> </span><span class="p">&amp;</span>
</pre></div>
</div>
<p>Equilibration:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>grompp<span class="w"> </span>-f<span class="w"> </span>../sirah.ff/tutorial/1/GPU/eq_CGDNA.mdp<span class="w"> </span>-p<span class="w"> </span>../topol.top<span class="w"> </span>-po<span class="w"> </span>eq.mdp<span class="w"> </span>-n<span class="w"> </span>../dna_cg_ion.ndx<span class="w"> </span>-c<span class="w"> </span>dna_cg_em.gro<span class="w"> </span>-o<span class="w"> </span>dna_cg_eq.tpr<span class="w"> </span>mdrun<span class="w"> </span>-deffnm<span class="w"> </span>dna_cg_eq<span class="w"> </span><span class="p">&amp;</span>&gt;<span class="w"> </span>EQ.log<span class="w"> </span><span class="p">&amp;</span>
</pre></div>
</div>
<p>Production (100ns):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gmx<span class="w"> </span>grompp<span class="w"> </span>-f<span class="w"> </span>../sirah.ff/tutorial/1/GPU/md_CGDNA.mdp<span class="w"> </span>-p<span class="w"> </span>../topol.top<span class="w"> </span>-po<span class="w"> </span>md.mdp<span class="w"> </span>-n<span class="w"> </span>../dna_cg_ion.ndx<span class="w"> </span>-c<span class="w"> </span>dna_cg_eq.gro<span class="w"> </span>-o<span class="w"> </span>dna_cg_md.tpr<span class="w"> </span>mdrun<span class="w"> </span>-deffnm<span class="w"> </span>dna_cg_md<span class="w"> </span><span class="p">&amp;</span>&gt;<span class="w"> </span>MD.log<span class="w"> </span><span class="p">&amp;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>GPU flags were set for GROMACS 4.6.7, different versions may complain about some specifications.</p>
</div>
</section>
<section id="visualizing-the-simulation">
<h1>1.5. Visualizing the simulation<a class="headerlink" href="#visualizing-the-simulation" title="Link to this heading"></a></h1>
<p>That’s it! Now you can analyze the trajectory.</p>
<p>Process the output trajectory at folder run/ to account for the Periodic Boundary Conditions (PBC):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gmx<span class="w"> </span>trjconv<span class="w"> </span>-s<span class="w"> </span>dna_cg_em.tpr<span class="w"> </span>-f<span class="w"> </span>dna_cg_md.xtc<span class="w"> </span>-o<span class="w"> </span>dna_cg_md_pbc.xtc<span class="w"> </span>-n<span class="w"> </span>../dna_cg_ion.ndx<span class="w"> </span>-ur<span class="w"> </span>compact<span class="w"> </span>-center<span class="w"> </span>-pbc<span class="w"> </span>mol
</pre></div>
</div>
<p>When prompted, choose <em>DNA</em> for centering and <em>System</em> for output.</p>
<p>Now you can check the simulation using VMD:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>vmd<span class="w"> </span>../dna_cg_ion.psf<span class="w"> </span>../dna_cg_ion.gro<span class="w"> </span>dna_cg_md_pbc.xtc<span class="w"> </span>-e<span class="w"> </span>../sirah.ff/tools/sirah_vmdtk.tcl
</pre></div>
</div>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, BA, SL, SM.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>
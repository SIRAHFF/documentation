<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>7.1. Build CG representations &mdash; SIRAH Force Field v_1.0 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=3060a628"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            SIRAH Force Field
          </a>
              <div class="version">
                v_1.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Manual</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../About%20SIRAH.html">About SIRAH</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Citation.html">Citations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Further%20reading.html">Further Reading</a></li>
<li class="toctree-l1"><a class="reference internal" href="../FAQ.html">FAQs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Developers.html">Developers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Tutorials%20amber.html">AMBER</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Tutorials%20gromacs.html">GROMACS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Tutorials%20namd.html">NAMD</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Tutorials%20sirahtools.html">SIRAH tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Tutorials%20analysis.html">Basic analyses VMD</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">SIRAH Force Field</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">7.1. Build CG representations</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/AMBER/Tutorial-7.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <p>This tutorial shows how to use the SIRAH force field to perform a coarse grained (CG) simulation of a protein embedded in a lipid bilayer using explicit solvent (called WatFour, WT4). The main references for
this tutorial are: <a class="reference external" href="https://doi.org/10.1021/acs.jctc.9b00006">Machado et al.</a>, <a class="reference external" href="https://doi.org/10.1021/acs.jctc.9b00435">Barrera et al.</a>, and <a class="reference external" href="https://academic.oup.com/bioinformatics/article/32/10/1568/1743152">Machado &amp; Pantano</a>.
We strongly advise you to read these articles before starting the tutorial.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We strongly advise you to read and complete <a class="reference internal" href="../Tutorials%20amber.html#tutorial-5"><span class="std std-ref">Tutorial 5</span></a> and <a class="reference internal" href="../Tutorials%20amber.html#tutorial-6"><span class="std std-ref">Tutorial 6</span></a> before starting.</p>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Check the <a class="reference internal" href="../Tutorials%20amber.html#download-amber"><span class="std std-ref">Setting up SIRAH</span></a> section for download and set up details before starting this tutorial.
Since this is <strong>Tutorial 7</strong>, remember to replace <code class="docutils literal notranslate"><span class="pre">X.X</span></code> and the files corresponding to this tutorial can be found in: <code class="docutils literal notranslate"><span class="pre">sirah_[version].amber/tutorial/7/</span></code></p>
</div>
<section id="build-cg-representations">
<h1>7.1. Build CG representations<a class="headerlink" href="#build-cg-representations" title="Link to this heading"></a></h1>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>The mapping to CG requires the correct protonation state of each residue at a given pH. We recommend using the <a class="reference external" href="https://www.charmm-gui.org/">CHARMM-GUI server</a> and use the <strong>PDB Reader &amp; Manipulator</strong> to prepare your system. An account is required to access any of the CHARMM-GUI Input Generator modules, and it can take up to 24 hours to obtain one.</p>
<p>See <a class="reference internal" href="../Tutorials%20amber.html#tutorial-5"><span class="std std-ref">Tutorial 5</span></a> for cautions while preparing and mapping atomistic proteins to SIRAH.</p>
</div>
<p>Map the atomistic structure of protein <a class="reference external" href="https://www.rcsb.org/structure/2KYV">2KYV</a> to its CG representation:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./sirah.amber/tools/CGCONV/cgconv.pl<span class="w"> </span>-i<span class="w"> </span>sirah.amber/tutorial/7/2kyv.pqr<span class="w"> </span>-o<span class="w"> </span>2kyv_cg.pdb
</pre></div>
</div>
<p>The input file <code class="docutils literal notranslate"><span class="pre">-i</span></code> 2kyv.pqr contains the atomistic representation of <a class="reference external" href="https://www.rcsb.org/structure/2KYV">2KYV</a> structure at pH <strong>7.0</strong>, while the output <code class="docutils literal notranslate"><span class="pre">-o</span></code> 2kyv_cg.pdb is its SIRAH CG representation.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>If you already have an atomistic protein within a membrane, then you can simply map the entire system to SIRAH (this is highly recommended) and skip the step 2, however clipping the membrane patch may be required to set a correct solvation box (see bellow). By default no mapping is applied to lipids, as there is no standard naming convention for them. So users are requested to append a MAP file from the list in <a class="reference internal" href="../Tutorials%20amber.html#table"><span class="std std-ref">Table 1</span></a>, by setting the flag <code class="docutils literal notranslate"><span class="pre">-a</span></code> in <code class="docutils literal notranslate"><span class="pre">cgconv.pl</span></code>. We recommend using <a class="reference external" href="https://m3g.github.io/packmol/">PACKMOL</a> for building the system. Reference building-block structures are provided at folder <code class="docutils literal notranslate"><span class="pre">sirah.amber/PDB/</span></code>, which agree with the mapping scheme <code class="docutils literal notranslate"><span class="pre">sirah.amber/tools/CGCONV/maps/tieleman_lipid.map</span></code>. See <a class="reference internal" href="../FAQ.html"><span class="doc">FAQs</span></a> for cautions on mapping lipids to SIRAH and tips on using fragment-based topologies.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>This an advanced usage of the script <strong>cgconv.pl</strong>, you can learn other capabilities from its help by typing:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./sirah.amber/tools/CGCONV/cgconv.pl<span class="w"> </span>-h
</pre></div>
</div>
</div>
<section id="embed-the-protein-in-a-lipid-bilayer">
<h2>7.1.1. Embed the protein in a lipid bilayer<a class="headerlink" href="#embed-the-protein-in-a-lipid-bilayer" title="Link to this heading"></a></h2>
<p>We will show one possible way to do it by starting from a pre-equilibrated CG membrane patch.</p>
<p>In <code class="docutils literal notranslate"><span class="pre">sirah_[version].amber/tutorial/7/</span></code> you will find a pre-stabilized CG DMPC bilayer patch, concatenate it with the previously generated CG representation of the phospholamban (PLN) pentamer (PDB code: <a class="reference external" href="https://www.rcsb.org/structure/2KYV">2KYV</a>):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>head<span class="w"> </span>-qn<span class="w"> </span>-1<span class="w"> </span>2kyv_cg.pdb<span class="w"> </span>./sirah.amber/tutorial/7/DMPC_cg.pdb<span class="w"> </span>&gt;<span class="w"> </span>2kyv_DMPC_cg_init.pdb
</pre></div>
</div>
<p>Luckily, we already oriented the protein inside the membrane. For setting up your own system you can go to <a class="reference external" href="https://opm.phar.umich.edu/">Orientations of Proteins in Membranes (OPM) database</a> and (if your structure is available) use the dummy atoms provided there to make them match with your membrane model (see <strong>Figure 1</strong>).</p>
<figure class="align-center" id="id1">
<a class="reference internal image-reference" href="../_images/Tuto7.png"><img alt="../_images/Tuto7.png" src="../_images/Tuto7.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-text"><strong>Figure 1.</strong> Protein oriented inside the membrane from the OPM database with dummy atoms represented as orange spheres.</span><a class="headerlink" href="#id1" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="delete-close-contact-lipid-molecules">
<h2>7.1.2. Delete close contact lipid molecules<a class="headerlink" href="#delete-close-contact-lipid-molecules" title="Link to this heading"></a></h2>
<p>We need to use VMD to to delete lipid molecules in close contact with the protein. For a proper treatment and visualization of the system in VMD you must first generate the molecular topology and initial coordinate files.</p>
<p>Use a text editor to create the file <code class="docutils literal notranslate"><span class="pre">geninit.leap</span></code> including the following lines:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp"># </span>Load<span class="w"> </span>SIRAH<span class="w"> </span>force<span class="w"> </span>field
<span class="go">addPath ./sirah.amber</span>
<span class="go">source leaprc.sirah</span>

<span class="gp"># </span>Load<span class="w"> </span>model
<span class="go">ProtMem = loadpdb 2kyv_DMPC_cg_init.pdb</span>

<span class="gp"># </span>Save<span class="w"> </span>Parms
<span class="go">saveAmberParmNetcdf ProtMem 2kyv_DMPC_cg_init.prmtop 2kyv_DMPC_cg_init.ncrst</span>

<span class="gp"># </span>EXIT
<span class="go">quit</span>
</pre></div>
</div>
<p>Run the LEaP application to generate the molecular topology and initial coordinate files:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>tleap<span class="w"> </span>-f<span class="w"> </span>geninit.leap
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Warning messages about long, triangular or square bonds in <code class="docutils literal notranslate"><span class="pre">leap.log</span></code> file are fine and expected due to the CG topology.</p>
</div>
<p>Now, open the files on VMD:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>vmd<span class="w"> </span>2kyv_DMPC_cg_init.prmtop<span class="w"> </span>2kyv_DMPC_cg_init.ncrst<span class="w"> </span>-e<span class="w"> </span>sirah.amber/tools/sirah_vmdtk.tcl
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>VMD assigns default radius to unknown atom types, the script <code class="docutils literal notranslate"><span class="pre">sirah_vmdtk.tcl</span></code> sets the right
ones, according to the CG representation. It also provides a kit of useful selection macros, coloring methods and backmapping utilities.
Use the command <code class="docutils literal notranslate"><span class="pre">sirah_help</span></code> in the Tcl/Tk console of VMD to access the manual pages. To learn about SIRAH Tools’ capabilities, you can also go to the <a class="reference internal" href="../Tutorials%20sirahtools.html#sirah-tools"><span class="std std-ref">SIRAH Tools tutorial</span></a>.</p>
</div>
<p>In the VMD main window, select <em>Graphics</em> &gt; <em>Representations</em>. In the <em>Selected Atoms</em> box, type:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>not (same residue as (sirah_membrane within 3.5 of sirah_protein) or (sirah_membrane and x &lt; 5 or x &gt; 142 or y &lt; 2 or y &gt; 140))
</pre></div>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>In the first part of the selection, lipid molecules in close contact with the protein are removed. The second one is made to “trim” the membrane patch, deleting lipids with acyl chains located in the periodic boundary images. This is frequent when using pre-equilibrated membrane patches and is necessary to avoid clashes in the following steps.</p>
</div>
<p>To save the refined protein-membrane system, in the VMD main window click on <code class="docutils literal notranslate"><span class="pre">2kyv_DMPC_cg_init.prmtop</span></code>, then select <em>File</em> &gt; <em>Save Coordinates</em>. In the <em>Selected atoms</em> option choose the selection you have just created and Save as <code class="docutils literal notranslate"><span class="pre">2kyv_DMPC_cg.pdb</span></code>.</p>
<p>From now on it is just normal AMBER stuff!</p>
</section>
</section>
<section id="prepare-leap-input">
<h1>7.2. Prepare LEaP input<a class="headerlink" href="#prepare-leap-input" title="Link to this heading"></a></h1>
<p>Use a text editor to create the file <code class="docutils literal notranslate"><span class="pre">gensystem.leap</span></code> including the following lines:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp"># </span>Load<span class="w"> </span>SIRAH<span class="w"> </span>force<span class="w"> </span>field
<span class="go">addPath ./sirah.amber</span>
<span class="go">source leaprc.sirah</span>

<span class="gp"># </span>Load<span class="w"> </span>model
<span class="go">Lipid = loadpdb DMPC64_cg.pdb</span>

<span class="gp"># </span>Add<span class="w"> </span>solvent,<span class="w"> </span>counterions<span class="w"> </span>and<span class="w"> </span><span class="m">0</span>.15M<span class="w"> </span>NaCl
<span class="gp"># </span>Tuned<span class="w"> </span>solute-solvent<span class="w"> </span>closeness<span class="w"> </span><span class="k">for</span><span class="w"> </span>best<span class="w"> </span>hydration
<span class="go">solvateBox Lipid WT4BOX {0 0 40} 0.7</span>
<span class="go">addIonsRand Lipid NaW 33 ClW 33</span>

<span class="gp"># </span>Save<span class="w"> </span>Parms
<span class="go">saveAmberParmNetcdf protein DMPC64_cg.prmtop DMPC64_cg.ncrst</span>

<span class="gp"># </span>EXIT
<span class="go">quit</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>The available electrolyte species in SIRAH force field are: <code class="docutils literal notranslate"><span class="pre">Na⁺</span></code> (NaW), <code class="docutils literal notranslate"><span class="pre">K⁺</span></code> (KW) and <code class="docutils literal notranslate"><span class="pre">Cl⁻</span></code> (ClW) which represent solvated ions in solution. One ion pair (e.g., NaW-ClW) each 34 WT4 molecules results in a salt concentration of ~0.15M (see <a class="reference internal" href="../Tutorials%20amber.html#appendix"><span class="std std-ref">Appendix</span></a> for details). Counterions were added according to <a class="reference external" href="https://pubs.acs.org/doi/10.1021/acs.jctc.9b00953">Machado et al.</a>.</p>
</div>
</section>
<section id="run-leap">
<h1>7.3. Run LEaP<a class="headerlink" href="#run-leap" title="Link to this heading"></a></h1>
<p>Run the LEaP application to generate the molecular topology and initial coordinate files:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>tleap<span class="w"> </span>-f<span class="w"> </span>gensystem.leap
</pre></div>
</div>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>Warning messages about long, triangular or square bonds in <code class="docutils literal notranslate"><span class="pre">leap.log</span></code> file are fine and expected due to the CG topology.</p>
</div>
<p>This should create a topology file <code class="docutils literal notranslate"><span class="pre">2kyv_DMPC_cg.prmtop</span></code> and a coordinate file <code class="docutils literal notranslate"><span class="pre">2kyv_DMPC_cg.ncrst</span></code>.</p>
<p>Use VMD to check how the CG model looks:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>vmd<span class="w"> </span>2kyv_DMPC_cg.prmtop<span class="w"> </span>2kyv_DMPC_cg.ncrst<span class="w"> </span>-e<span class="w"> </span>./sirah.amber/tools/sirah_vmdtk.tcl
</pre></div>
</div>
<p>By selecting +X, +Y and +Z periodic images from the <em>Periodic</em> tab in the <em>Graphical Representations</em> window you will see unwanted water near the
hydrophobic region of the membrane and small vacuum slices at box boundaries. In the following step we will fix these issues by deleting those water molecules and reducing the box dimensions a few angstroms. See <a class="reference internal" href="../FAQ.html"><span class="doc">FAQs</span></a> for issues on membrane systems in Amber. If you do not find your issue please start a discussion in our <a class="reference external" href="https://github.com/SIRAHFF/documentation/discussions">github discussion page F&amp;Q</a>.</p>
</section>
<section id="resize-the-box-with-cpptraj">
<h1>7.4. Resize the box with CPPTRAJ<a class="headerlink" href="#resize-the-box-with-cpptraj" title="Link to this heading"></a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>As PACKMOL does not consider periodicity while building up the system, increasing the XY box sides a few Angstroms may be required to avoid bad contacts between images.</p>
</div>
<p>Use a text editor to create the file <code class="docutils literal notranslate"><span class="pre">resize_box.cpptraj</span></code> including the following lines:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp"># </span>Set<span class="w"> </span>reference<span class="w"> </span>coordinate<span class="w"> </span>file
<span class="go">reference 2kyv_DMPC_cg.ncrst</span>

<span class="gp"># </span>Remove<span class="w"> </span>water<span class="w"> </span>using<span class="w"> </span>distance-based<span class="w"> </span>masks
<span class="go">strip :WT4&amp;(@BCT1,BCT2,BC13,BC23&lt;:12.0) parmout 2kyv_DMPC_cg.prmtop</span>

<span class="gp"># </span>New<span class="w"> </span>box<span class="w"> </span>dimensions
<span class="go">box x 128 y 128 z 114</span>

<span class="gp"># </span>Amber<span class="w"> </span>NetCDF<span class="w"> </span>Restart<span class="w"> </span>generation
<span class="go">trajout 2kyv_DMPC_cg_nb.ncrst</span>

<span class="gp"># </span>Do<span class="w"> </span>it!
<span class="go"> go</span>

<span class="gp"># </span>EXIT
<span class="go"> quit</span>
</pre></div>
</div>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>This is a critical step when preparing membrane systems to simulate with Amber. In this case, the new box dimensions were set after some trial and error tests to allow for limited overlap between periodic box images. An excessive overlap may lead to important atom clashes an eventual system explosion during minimization/simulation, while insufficient overlap may impact the membrane cohesivity at PBC boundaries leading to pore formations or other issues.</p>
</div>
<p>Run the CPPTRAJ application application to adjust the size of the simulation box:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cpptraj<span class="w"> </span>-p<span class="w"> </span>2kyv_DMPC_cg.prmtop<span class="w"> </span>-y<span class="w"> </span>2kyv_DMPC_cg.ncrst<span class="w"> </span>-i<span class="w"> </span>resize_box.cpptraj
</pre></div>
</div>
<p>Once again, use VMD to check the PBC images in the new box of the system:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>vmd<span class="w"> </span>2kyv_DMPC_cg.prmtop<span class="w"> </span>2kyv_DMPC_cg_nb.ncrst<span class="w"> </span>-e<span class="w"> </span>./sirah.amber/tools/sirah_vmdtk.tcl
</pre></div>
</div>
</section>
<section id="run-the-simulation">
<h1>7.5. Run the simulation<a class="headerlink" href="#run-the-simulation" title="Link to this heading"></a></h1>
<p>Make a new folder for the run:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mkdir<span class="w"> </span>-p<span class="w"> </span>run<span class="p">;</span><span class="w"> </span><span class="nb">cd</span><span class="w"> </span>run
</pre></div>
</div>
<p>The folder <code class="docutils literal notranslate"><span class="pre">sirah.amber/tutorial/7/</span></code> contains typical input files for energy minimization
(<code class="docutils literal notranslate"><span class="pre">em1_Prot-Lip.in</span></code> and <code class="docutils literal notranslate"><span class="pre">em2_Prot-Lip.in</span></code>), heating (<code class="docutils literal notranslate"><span class="pre">heat_Prot-Lip.in</span></code>), equilibration (<code class="docutils literal notranslate"><span class="pre">eq_Prot-Lip.in</span></code>) and production (<code class="docutils literal notranslate"><span class="pre">md_Prot-Lip.in</span></code>) runs. Please check carefully the input flags.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<blockquote>
<div><p><strong>Some commonly used flags in Amber</strong></p>
</div></blockquote>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">-i</span></code>: Input file.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-o</span></code>: Output file.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-p</span></code>: Parameter/topology file.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-c</span></code>: Coordinate file.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-r</span></code>: Restart file.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-x</span></code>: Trajectory file.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-ref</span></code>: Reference file</p></li>
</ul>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>These input files are executed by the <strong>GPU</strong> implementation of <code class="docutils literal notranslate"><span class="pre">pmemd.cuda</span></code>. Other available modules are <code class="docutils literal notranslate"><span class="pre">sander</span></code> or <code class="docutils literal notranslate"><span class="pre">pmemd</span></code>, which are both <strong>CPU</strong> implementations of Amber.</p>
<p>However, this simulation is time consuming owing to the system’s size. A parallel or CUDA implementation of Amber is advised.</p>
</div>
<p><strong>Energy Minimization of side chains by restraining the backbone:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pmemd.cuda<span class="w"> </span>-O<span class="w"> </span>-i<span class="w"> </span>../sirah.amber/tutorial/7/em1_Prot-Lip.in<span class="w"> </span>-p<span class="w"> </span>../2kyv_DMPC_cg.prmtop<span class="w"> </span>-c<span class="w"> </span>../2kyv_DMPC_cg_nb.ncrst<span class="w"> </span>-ref<span class="w"> </span>../2kyv_DMPC_cg_nb.ncrst<span class="w"> </span>-o<span class="w"> </span>2kyv_DMPC_cg_em_1.out<span class="w"> </span>-r<span class="w"> </span>2kyv_DMPC_cg_em_1.ncrst<span class="w"> </span><span class="p">&amp;</span>
</pre></div>
</div>
<p><strong>Energy Minimization of of the whole system:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pmemd.cuda<span class="w"> </span>-O<span class="w"> </span>-i<span class="w"> </span>../sirah.amber/tutorial/7/em2_Prot-Lip.in<span class="w"> </span>-p<span class="w"> </span>../2kyv_DMPC_cg.prmtop<span class="w"> </span>-c<span class="w"> </span>2kyv_DMPC_cg_em_1.ncrst<span class="w"> </span>-ref<span class="w"> </span>2kyv_DMPC_cg_em_1.ncrst<span class="w"> </span>-o<span class="w"> </span>2kyv_DMPC_cg_em_2.out<span class="w"> </span>-r<span class="w"> </span>2kyv_DMPC_cg_em_2.ncrst<span class="w"> </span><span class="p">&amp;</span>
</pre></div>
</div>
<p><strong>Heating:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pmemd.cuda<span class="w"> </span>-O<span class="w"> </span>-i<span class="w"> </span>../sirah.amber/tutorial/7/heat_Prot-Lip.in<span class="w"> </span>-p<span class="w"> </span>../2kyv_DMPC_cg.prmtop<span class="w"> </span>-c<span class="w"> </span>2kyv_DMPC_cg_em_2.ncrst<span class="w"> </span>-ref<span class="w"> </span>2kyv_DMPC_cg_em_2.ncrst<span class="w"> </span>-o<span class="w"> </span>2kyv_DMPC_cg_eq_0.out<span class="w"> </span>-r<span class="w"> </span>2kyv_DMPC_cg_eq_0.ncrst<span class="w"> </span>-x<span class="w"> </span>2kyv_DMPC_cg_eq_0.nc<span class="w"> </span><span class="p">&amp;</span>
</pre></div>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>To avoid “<em>skinnb errors</em>” on GPU due to large box size fluctuations, the system must be equilibrated by several “short” runs using a large <em>skinnb</em> value. The number and length of the runs may vary according to the characteristic stabilization times of the system. For more information visit the <a class="reference external" href="http://ambermd.org/tutorials/advanced/tutorial16/">Amber tutorial on lipids</a>.</p>
</div>
<p><strong>Periodic box equilibration in GPU code (500 ps x 9):</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="k">for</span><span class="w"> </span>i<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="k">$(</span>seq<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">9</span><span class="k">)</span>
<span class="k">do</span>
<span class="w">        </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;running equilibration </span><span class="nv">$i</span><span class="s2">&quot;</span>
<span class="w">        </span>pmemd.cuda<span class="w"> </span>-O<span class="w"> </span><span class="se">\</span>
<span class="w">        </span>-i<span class="w"> </span>../sirah.amber/tutorial/7/heat_Prot-Lip.in<span class="w"> </span><span class="se">\</span>
<span class="w">        </span>-p<span class="w"> </span>../2kyv_DMPC_cg.prmtop<span class="w"> </span><span class="se">\</span>
<span class="w">        </span>-c<span class="w"> </span>2kyv_DMPC_cg_eq_<span class="k">$((</span><span class="nv">$i</span><span class="w"> </span><span class="o">-</span><span class="m">1</span><span class="k">))</span>.ncrst<span class="w"> </span><span class="se">\</span>
<span class="w">        </span>-ref<span class="w"> </span>2kyv_DMPC_cg_eq_<span class="k">$((</span><span class="nv">$i</span><span class="w"> </span><span class="o">-</span><span class="m">1</span><span class="k">))</span>.ncrst<span class="w"> </span><span class="se">\</span>
<span class="w">        </span>-o<span class="w"> </span>2kyv_DMPC_cg_eq_<span class="nv">$i</span>.out<span class="w"> </span><span class="se">\</span>
<span class="w">        </span>-r<span class="w"> </span>2kyv_DMPC_cg_eq_<span class="nv">$i</span>.ncrst<span class="w"> </span><span class="se">\</span>
<span class="w">        </span>-x<span class="w"> </span>2kyv_DMPC_cg_eq_<span class="nv">$i</span>.nc
<span class="k">done</span><span class="w"> </span><span class="p">&amp;</span>
</pre></div>
</div>
<p><strong>Production (1000ns):</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pmemd.cuda<span class="w"> </span>-O<span class="w"> </span>-i<span class="w"> </span>../sirah.amber/tutorial/7/md_Prot-Lip.in<span class="w"> </span>-p<span class="w"> </span>../2kyv_DMPC_cg.prmtop<span class="w"> </span>-c<span class="w"> </span>2kyv_DMPC_cg_eq_9.ncrst<span class="w"> </span>-o<span class="w"> </span>2kyv_DMPC_cg_md.out<span class="w"> </span>-r<span class="w"> </span>2kyv_DMPC_cg_md.ncrst<span class="w"> </span>-x<span class="w"> </span>2kyv_DMPC_cg_md.nc<span class="w"> </span><span class="p">&amp;</span>
</pre></div>
</div>
</section>
<section id="visualizing-the-simulation">
<h1>7.6. Visualizing the simulation<a class="headerlink" href="#visualizing-the-simulation" title="Link to this heading"></a></h1>
<p>That’s it! Now you can analyze the trajectory.</p>
<p>Process the output trajectory to account for the Periodic Boundary Conditions (PBC):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;autoimage\ngo\nquit\n&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>cpptraj<span class="w"> </span>-p<span class="w"> </span>../2kyv_DMPC_cg.prmtop<span class="w"> </span>-y<span class="w"> </span>2kyv_DMPC_cg_md.nc<span class="w"> </span>-x<span class="w"> </span>2kyv_DMPC_cg_md_pbc.nc<span class="w"> </span>--interactive
</pre></div>
</div>
<p>Now you can check the simulation using VMD:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">vmd</span> <span class="o">../</span><span class="mi">2</span><span class="n">kyv_DMPC_cg</span><span class="o">.</span><span class="n">prmtop</span> <span class="mi">2</span><span class="n">kyv_DMPC_cg_md_pbc</span><span class="o">.</span><span class="n">nc</span> <span class="o">-</span><span class="n">e</span> <span class="o">../</span><span class="n">sirah</span><span class="o">.</span><span class="n">amber</span><span class="o">/</span><span class="n">tools</span><span class="o">/</span><span class="n">sirah_vmdtk</span><span class="o">.</span><span class="n">tcl</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The file <code class="docutils literal notranslate"><span class="pre">sirah_vmdtk.tcl</span></code> is a Tcl script that is part of SIRAH Tools and contains the macros to properly visualize the coarse-grained structures in VMD. Use the command <code class="docutils literal notranslate"><span class="pre">sirah-help</span></code> in the Tcl/Tk console of VMD to access the manual pages. To learn about SIRAH Tools’ capabilities, you can also go to the <a class="reference internal" href="../Tutorials%20sirahtools.html#sirah-tools"><span class="std std-ref">SIRAH Tools tutorial</span></a>.</p>
</div>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, BA, SL, SM.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>
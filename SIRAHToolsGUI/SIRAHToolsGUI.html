

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-SKLFMD8CGT"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-SKLFMD8CGT');
    </script>
    
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Overview &mdash; SIRAH Force Field  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../_static/custom.css" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../_static/doctools.js?v=9a2dae69"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            SIRAH Force Field
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Manual</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../About%20SIRAH.html">About SIRAH</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Background%20SIRAH.html">Background</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Citation.html">Citations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Further%20reading.html">Further Reading</a></li>
<li class="toctree-l1"><a class="reference internal" href="../FAQ.html">FAQs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Developers.html">Developers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Tutorials%20amber.html">AMBER</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Tutorials%20gromacs.html">GROMACS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Tutorials%20namd.html">NAMD</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Tutorials%20sirahtools.html">SIRAH tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Tutorials%20analysis.html">Basic analyses VMD</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Tutorials%20sirahgui.html">SIRAH Tools GUI</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">SIRAH Force Field</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Overview</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/SIRAHToolsGUI/SIRAHToolsGUI.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="admonition note">
<p class="admonition-title">Note</p>
<p>Please report bugs, errors or enhancement requests through <a class="reference external" href="https://github.com/SIRAHFF/SIRAH-Tools-GUI/issues">Issue Tracker</a> or if you have a question about SIRAH open a <a class="reference external" href="https://github.com/SIRAHFF/documentation/discussions">New Discussion</a>.</p>
</div>
<section id="overview">
<h1>Overview<a class="headerlink" href="#overview" title="Link to this heading"></a></h1>
<p>SIRAH Tools GUI is a user-friendly interface that combines VMD and Python scripts for molecular dynamics (MD) simulation analysis. The main purpose of SIRAH Tools GUI is to aid the analysis of coarse-grained (CG) SIRAH force field MD simulations, providing users with the most widely used trajectory analyses based on VMD syntax and operations without the need of familiarity with its scripting language.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Some of SIRAH Tools GUI features are not specific to CG or SIRAH force field nomenclature. As a result, it is applicable to any MD simulation that makes use of VMD-compatible topology and trajectory files.</p>
</div>
<p>The GUI should be easy to use for people who are proficient in both VMD and MD. For beginners, SIRAH Tools GUI is an ideal tool, helping them get past the first learning curve that most MD visualization software imposes.</p>
<p>In addition, it was constructed in a modular manner, combining TCL (<code class="docutils literal notranslate"><span class="pre">.tcl</span></code>) and Python (<code class="docutils literal notranslate"><span class="pre">.py</span></code>) scripts (Figure 1), enabling all users to customize the scripts without changing its code.</p>
<figure class="align-center" id="id11">
<a class="reference internal image-reference" href="../_images/Figure_1_SirahGui.png"><img alt="../_images/Figure_1_SirahGui.png" src="../_images/Figure_1_SirahGui.png" style="width: 70%;" />
</a>
<figcaption>
<p><span class="caption-text"><strong>Figure 1.</strong> SIRAH Tools GUI organization.</span><a class="headerlink" href="#id11" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="installing">
<h1>Installing<a class="headerlink" href="#installing" title="Link to this heading"></a></h1>
<p>The <cite>environment.yml</cite> provided defines all Python dependencies and modules required by SIRAH Tools GUI:</p>
<ul class="simple">
<li><p><strong>Python interpreter</strong>
- <cite>python=3.11.5</cite>
- (alternative: <cite>python=3.10.15</cite>)</p></li>
<li><p><strong>Conda packages</strong>
- <cite>numpy=1.24.3</cite>
- <cite>pandas=2.0.3</cite>
- <cite>matplotlib=3.7.2</cite>
- <cite>seaborn=0.12.2</cite>
- <cite>tqdm=4.65.0</cite></p></li>
<li><p><strong>pip-installed modules</strong>
- <cite>ttkbootstrap==1.10.1</cite>    — enhanced GUI styling
- <cite>fpdf==1.7.2</cite>             — PDF report generation
- <cite>imageio==2.35.1</cite>         — image and GIF creation
- <cite>screeninfo==0.8</cite>         — screen-resolution detection
- <cite>seaborn==0.12.2</cite>         — ensures consistent seaborn version</p></li>
</ul>
<p>These dependencies guarantee compatibility and stability across all SIRAH Tools GUI features.</p>
<p><strong>1. Clone the Repository:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/SIRAHFF/SIRAH-Tools-GUI.git
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>SIRAH-Tools-GUI/
</pre></div>
</div>
<p>Unzip file:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>unzip<span class="w"> </span>SIRAH-Tools-GUI_v1.0.zip
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>SIRAH-Tools-GUI_v1.0/
</pre></div>
</div>
<p><strong>2. Create the Conda Environment:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>conda<span class="w"> </span>env<span class="w"> </span>create<span class="w"> </span>-f<span class="w"> </span>env_sirah_tools.yml
</pre></div>
</div>
<p>Activate the Environment:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>conda<span class="w"> </span>activate<span class="w"> </span>sirah-gui
</pre></div>
</div>
<p>check python version:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python<span class="w"> </span>--version
</pre></div>
</div>
<p><strong>3. Run the aplication:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python<span class="w"> </span>sirah-tools-gui.py
</pre></div>
</div>
<p>The GUI should launch, allowing you to access all the features.</p>
<p><strong>Optional (Advised): Create an Alias</strong></p>
<p>To simplify usage, add an alias in your shell configuration file (e.g., ~/.bashrc or ~/.zshrc):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">alias</span><span class="w"> </span>sirah-gui<span class="o">=</span><span class="s2">&quot;conda activate sirah-gui &amp;&amp; python ``/path/to/SIRAH-Tools-GUI/sirah-tools-gui.py``</span>
</pre></div>
</div>
<p>Be sure to set <code class="docutils literal notranslate"><span class="pre">/path/to/SIRAH-Tools-GUI/sirah-tools-gui.py</span></code> to the right path on your computer.</p>
<p>After reloading your shell, simply run:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sirah-gui
</pre></div>
</div>
<p>If everything went as planned, you should be able to launch the SIRAH Tools GUI interface (Figure 2) and use all of its features.</p>
<figure class="align-center" id="id12">
<a class="reference internal image-reference" href="../_images/Figure_2_SirahGui.png"><img alt="../_images/Figure_2_SirahGui.png" src="../_images/Figure_2_SirahGui.png" style="width: 100%;" />
</a>
<figcaption>
<p><span class="caption-text"><strong>Figure 2.</strong> SIRAH Tools Graphical User Interface (GUI) screen to perform MD simulation analysis. It contains five tabs that carry out various analyses and tasks.</span><a class="headerlink" href="#id12" title="Link to this image"></a></p>
</figcaption>
</figure>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>SIRAH Tools GUI automatically detects if VMD is set in the system path, this is essential for the correct operation of SIRAH Tools GUI. If VMD is not set up correctly, a warning will be displayed and the tabs will be disabled.</p>
</div>
</section>
<section id="example-of-how-to-use">
<h1>Example of how to use<a class="headerlink" href="#example-of-how-to-use" title="Link to this heading"></a></h1>
<p>This example shows how to analyze trajectory files using SIRAH Tools GUI. The main reference for this example are <strong>Ballesteros-Casallas et al [Manuscript in Preparation]</strong> and <a class="reference external" href="https://academic.oup.com/bioinformatics/article/32/10/1568/1743152">Machado &amp; Pantano</a>. The Nucleosome Core Particle (NCP) used here was previously discussed by <a class="reference external" href="https://doi.org/10.1016/j.bbrc.2017.09.086">Brandner et al</a> and  <a class="reference external" href="https://pubs.acs.org/doi/10.1021/acs.jpcb.4c03278">Cantero et al</a>. We strongly advise you to read these articles before starting this tutorial.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Before you can use SIRAH Tools GUI, trajectory files need to be prepared to take into account Periodic Boundary Conditions (PBC). For examples of how to do this, see <a class="reference external" href="https://amberhub.chpc.utah.edu/autoimage/">Amber</a>, <a class="reference external" href="https://manual.gromacs.org/current/onlinehelp/gmx-trjconv.html">GROMACS</a>, or <a class="reference external" href="https://www.ks.uiuc.edu/Research/vmd/plugins/pbctools/">NAMD</a> tutorials.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Apart from the <strong>“Load Files”</strong> tab that needs to be the first tab, the other tabs don’t need to follow an order. This means that the user can choose any of the tabs to do analysis without having to go through the others.</p>
</div>
<section id="loading-files-tab">
<h2>Loading Files tab<a class="headerlink" href="#loading-files-tab" title="Link to this heading"></a></h2>
<p>The <strong>Load Files tab</strong> allows loading AMBER, GROMACS, and NAMD simulation topologies and trajectories compatible with SIRAH force field MD simulations. See more details of the tab <a class="reference internal" href="../Tutorials%20sirahgui.html#loadfiles-devnotes"><span class="std std-ref">here</span></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The SIRAH Tools GUI works with VMD in text mode; therefore, it can be used on any system that can be loaded in VMD.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Windows may not support AMBER trajectories in NetCDF format (limited by VMD).</p>
</div>
<p>Let’s begin the example by using the SIRAH Tools GUI to open the NCP topology and trajectory files.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Here, the NCP trajectory file was processed to take into account Periodic Boundary Conditions (PBC) and solvent molecules (WT4 beads) were removed. This was done using tools outside SIRAH Tools GUI. For examples of how to do this, look at the Amber, GROMACS, or NAMD tutorials [create links].</p>
</div>
<p>First, set up the working directory. This will turn the button green and the path of the chosen directory will be displayed beside it (Figure 3A). All files created will be stored in the working directory.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Be sure that you selected a folder where you have permission to create and save files.</p>
</div>
<p>This will also enable the “New Directory” button (Figure 3A).</p>
<figure class="align-center" id="id13">
<a class="reference internal image-reference" href="../_images/Figure_3_SirahGui.png"><img alt="../_images/Figure_3_SirahGui.png" src="../_images/Figure_3_SirahGui.png" style="width: 80%;" />
</a>
<figcaption>
<p><span class="caption-text"><strong>Figure 3.</strong> The <em>Load Files</em> tab will appear like this after the topology and trajectory files have been set up and loaded. A) The first step to successfully use SIRAH Tools GUI is to set the working directory. B) The system must be loaded using the “Load System” button after the working directory has been set and the topology and trajectory files have been selected. C) No reference structure was imported, and the options “Time step” and “Step between frames” were set to the default values. D) The “View in VMD” button launches VMD with the loaded system. E) The “Reset” button will erase all data loaded.</span><a class="headerlink" href="#id13" title="Link to this image"></a></p>
</figcaption>
</figure>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Although it is optional, creating a new directory can help organize the working folder if it contains a lot of files.</p>
</div>
<p>Now, click the corresponding buttons to select the topology file and then the trajectory file. This will turn the buttons green and enable the “Load System” button. To load the files, click the “Load System” button. Beside the button, a “System Load” message will appear (Figure 3B).</p>
<p>For this tutorial, no reference file will be imported, and the options “Time step” and “Step between frames” will remain set to the default values used in SIRAH tutorials (since these values were used in the simulation) (Figure 3C).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If different values of “Time step” and “Step between frames” have been applied, users must set them to the appropriate values used in their simulation to make sure the analyses and plots are performed correctly.</p>
</div>
<p>If all went well, you should be able to click the “View in VMD” button (Figure 3D) to launch VMD and load the system (Figure 4).</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Although it is not required, visualizing the system in VMD can assist in determining whether any loading issues occurred before beginning any analysis.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Any data entered in the tab will be erased if the “Reset” button (Figure 3E) is clicked.</p>
</div>
<figure class="align-center" id="id14">
<a class="reference internal image-reference" href="../_images/Figure_4_SirahGui.png"><img alt="../_images/Figure_4_SirahGui.png" src="../_images/Figure_4_SirahGui.png" style="width: 70%;" />
</a>
<figcaption>
<p><span class="caption-text"><strong>Figure 4.</strong> System loaded in VMD using the button ‘View in VMD’. Once the files are loaded correctly, we are ready to start the analysis.</span><a class="headerlink" href="#id14" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>Upon loading the topology and trajectory information, we can start exploring SIRAH Tools GUI’s available analysis.</p>
</section>
<section id="basic-and-advanced-md-analyses">
<h2>Basic and Advanced MD Analyses<a class="headerlink" href="#basic-and-advanced-md-analyses" title="Link to this heading"></a></h2>
<p>Here let’s select the <strong>Analysis tab</strong>. This tab allows several types of MD simulation analysis using VMD syntax selections (e.g. name, resname, resid, etc.) or VMD macros. See more details of the tab <a class="reference internal" href="../Tutorials%20sirahgui.html#analysis-devnotes"><span class="std std-ref">here</span></a>.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Check out the <a class="reference external" href="https://sirahff.github.io/documentation/Tutorials%20sirahtools.html">SIRAH Tools tutorial</a> to learn more about VMD and SIRAH macros and how to use them.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The “Analyze” button will only be enabled if one or more options are selected in either the Basic Analysis or Advanced Analysis sections, but you are not required to check every checkbox.</p>
</div>
<p>For the <strong>Basic Analysis</strong> section, write “name GC or name PX” at the Selection box. Then check the boxes for RMSD, RMSF, and Radius of Gyration (RGYR) (Figure 5A).</p>
<figure class="align-center" id="id15">
<a class="reference internal image-reference" href="../_images/Figure_5_SirahGui.png"><img alt="../_images/Figure_5_SirahGui.png" src="../_images/Figure_5_SirahGui.png" style="width: 80%;" />
</a>
<figcaption>
<p><span class="caption-text"><strong>Figure 5.</strong> Analysis tab settings for analyses using “name GC or name PX” beads. A) Basic Analysis selection for the NCP system. B) Advanced Analysis selection for the NCP system. C) Selected options in the “Generate Report” section. D) No reference structure was imported, and the options “Time step” and “Step between frames” were set to the default values. However, a 10 frame skip was used. E) The “Analyze” button will perform all the selected actions. F) Only when an analysis is underway is the “Stop” button activated, and pressing it will halt the analysis’s progress.</span><a class="headerlink" href="#id15" title="Link to this image"></a></p>
</figcaption>
</figure>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Because the NCP simulation has proteins and DNA molecules, we can make a selection for both. The GC bead in SIRAH would be comparable to a protein carbon alpha atom and the PX bead would be comparable to a DNA phosphate atom.</p>
</div>
<p>For the <strong>Advanced Analysis</strong> section, let’s also write “name GC or name PX” next to both Selection 2 and Selection 3, and then check the boxes for SASA and RDF (Figure 5B).</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>It is necessary to fill out both selections in the “Advanced Analysis”. This is because the VMD command being used here uses specific flags depending on the analyses.  The selections in both boxes may be identical or different. For further information, please see the Developers notes’ information about the <em>Analysis</em> tab <a class="reference internal" href="../Tutorials%20sirahgui.html#analysis-devnotes"><span class="std std-ref">here</span></a>.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All the analyses are selected except “Distance”. This is because “Distance” can only be found between two distinct selections (two distinct beads, two distinct residues, two distinct molecules, etc). Choosing “name GC or name PX” in both boxes will give a zero distance because it is the same group of beads.</p>
</div>
<p>For the <strong>Generate Report</strong> section, check both <em>Generate PDF report</em> and <em>rmsf into pdb bfactor</em> (Figure 5C).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The PDB file generated here uses the first frame coordinates of the beads.</p>
</div>
<p>Lastly, let’s give the trajectory a 10-frame “Skip” in the “Parameters” section (Figure 5D). This will speed up the calculations and reduce the number of frames from 10.000 to 1.000. Since the NCP simulation used these “Time step” and “Step between frames” values, leave them at their default settings.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If different values of “Time step” and “Step between frames” have been applied in the MD simulation, users must set them to the appropriate values used in their simulation to make sure the analyses and plots are performed correctly.</p>
</div>
<p>Click on the “Analyze” button now that it’s enabled (Figure 5E). A pop-up window indicating that the calculation is running will be shown. Optionally, if required, you can stop the calculation using the “Stop” button (Figure 5F).</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The VMD output area displays information about the VMD execution (as in a terminal window). Thus, any problem or error within the VMD will appear here.</p>
</div>
<p>Once the calculation is complete a new folder <em>Analysis</em> is generated in the working directory.</p>
<p>In this example <strong>13</strong> files are generated into this folder. These correspond to the <code class="docutils literal notranslate"><span class="pre">.dat</span></code> files and the plots (<code class="docutils literal notranslate"><span class="pre">.png</span></code> files, ploted with python) of RMSD, RMSF, SASA, RGYR, RDF and its integral. The remaining files include the PDF report containing the plots of all analyses and a PDB file (<code class="docutils literal notranslate"><span class="pre">RMSF_protein.pdb</span></code>) with the RMSF values in the Beta factor column.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The way that the files are named (<em>Name of the Analysis_selection1_selection2.dat</em> or <em>Name of the Analysis_selection1_selection2.png</em>) facilitates the study of various selections in the same folder. New files are created by different selections, whereas files are rewritten over if the same selection is made again. Nevertheless, a pop-up box will question if the user wants to rewrite the files.</p>
</div>
<p>Some of the plots produced by the chosen analyses of the “Analysis” Tab are displayed in Figure 6.</p>
<figure class="align-center" id="id16">
<a class="reference internal image-reference" href="../_images/Figure_6_SirahGui.png"><img alt="../_images/Figure_6_SirahGui.png" src="../_images/Figure_6_SirahGui.png" style="width: 100%;" />
</a>
<figcaption>
<p><span class="caption-text"><strong>Figure 6.</strong> The “Analysis” tab’s outputs include a PDB file, RMSF, RMSD, SASA, RGYR, and RDF plots.</span><a class="headerlink" href="#id16" title="Link to this image"></a></p>
</figcaption>
</figure>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Any external plotting software or script should be able to use the .dat files. Additionally, the appearance of the plots can be enhanced by adjusting the plot functions (such as <code class="docutils literal notranslate"><span class="pre">plot_generic</span></code>, <code class="docutils literal notranslate"><span class="pre">plot_rmsf</span></code>, etc.) in the Python script (<code class="docutils literal notranslate"><span class="pre">/modules/analysis_tab.py</span></code>).</p>
</div>
</section>
<section id="calculating-intermolecular-and-intramolecular-contacts">
<h2>Calculating Intermolecular and Intramolecular Contacts<a class="headerlink" href="#calculating-intermolecular-and-intramolecular-contacts" title="Link to this heading"></a></h2>
<p>Here let’s select the <strong>Contacts</strong> tab. This tab allows the analysis of contacts between two selections, using VMD syntax selections (e.g. name, resname, resid, etc.) or VMD macros, using a cutoff distance as a criterion. See more details of the tab <a class="reference internal" href="../Tutorials%20sirahgui.html#contacts-devnotes"><span class="std std-ref">here</span></a>.</p>
<p>To better understand the contact tab, let’s split the example into two sections: <a class="reference internal" href="../Tutorials%20sirahgui.html#contacts-inter"><span class="std std-ref">Intermolecular contacts</span></a> and <a class="reference internal" href="../Tutorials%20sirahgui.html#contacts-intra"><span class="std std-ref">Intramolecular contacts</span></a>.</p>
<section id="intermolecular-contacts">
<span id="contacts-inter"></span><h3>Intermolecular contacts<a class="headerlink" href="#intermolecular-contacts" title="Link to this heading"></a></h3>
<p>To calculate intermolecular contacts, the choices must be in different molecules.
For the NCP trajectory, let’s designate Selection1 “name GC”, which gives us the backbone beads (GC) of the histone octamer, and Selection2 “name PX”, which gives us the DNA phosphate beads (Figure 7A).</p>
<figure class="align-center" id="id17">
<a class="reference internal image-reference" href="../_images/Figure_7_SirahGui.png"><img alt="../_images/Figure_7_SirahGui.png" src="../_images/Figure_7_SirahGui.png" style="width: 80%;" />
</a>
<figcaption>
<p><span class="caption-text"><strong>Figure 7.</strong> “Contacts” tab settings for intermolecular contacts analyses for the two selections “name GC” and “name PX” beads of the NCP system. A) Settings to contact analysis. Two selections are needed, these selections can be in the same or different molecules. Here, we are using selections from different molecules. The default numbers were set to speed up the calculation. B) Run contacts calculation. A distance matrix can also be calculated. Calculation progress will be displayed and can be stopped at any time. C) When the calculations are done, buttons to make the plots will become active.</span><a class="headerlink" href="#id17" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>Let’s leave the cutoff distance at default value of 8.00 Å and use a 100-frame skip (reducing the 10.000-frame long trajectory to 100 frames) (Figure 7A).</p>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>Keep in mind that the calculation will take longer if the selections have many beads or atoms or if there are a high number of frames to be processed, so be patient.</p>
</div>
<p>Leave the <em>Calculate Distance Matrix</em> unselected (Figure 7B) since the matrix here is asymmetric as a result of the varying quantities of GC beads on the histone backbone and PX beads on the DNA phosphates. This asymmetry is expected whenever the two interacting groups are of different sizes, which is typically the case in intermolecular contact analyses.</p>
<p>Click the “Run Contact Analysis” button (Figure 7B).</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The VMD output area will display the progress of the calculation. The calculation can be stopped using the “Stop” button if something goes wrong.</p>
</div>
<p>Once the calculation is complete a new folder <strong>Contacts</strong> is generated in the working directory. To aid in the creation of the contact plots, the “contact length”, “distance length”, “contacts”, “percentage”, and “timeline” .dat files will be created.</p>
<p>Buttons for creating <em>Native Contacts Conservation</em> and <em>Contact Map</em> plots will become active once the calculation is finished (Figure 7C).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <em>Distance Map By Frame</em> was not activated since no distance matrix was computed.</p>
</div>
<p>By clicking on the “Native Contacts Conservation” button, a plot of the conservation of the initial frame contacts between the selections during the simulation can be obtained (Figure 8A).</p>
<figure class="align-center" id="id18">
<a class="reference internal image-reference" href="../_images/Figure_8_SirahGui.png"><img alt="../_images/Figure_8_SirahGui.png" src="../_images/Figure_8_SirahGui.png" style="width: 100%;" />
</a>
<figcaption>
<p><span class="caption-text"><strong>Figure 8.</strong> Intermolecular contact plots between the GC beads on the histone backbone and PX beads on the DNA phosphates of the NCP simulation. A) The native conservation plot displays the conservation of native contacts (blue), the accuracy of these contacts (orange), and the total number of contacts by frame (green) during the simulation. B) The contact map heatmap shows the average duration of the contacts within contact distance of one another during the simulation.</span><a class="headerlink" href="#id18" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>By clicking on the <em>Contact Map</em> button, a heatmap of the contact duration between residue pairs of the selections within contact distance of one another, expressed as a percentage of simulation time, is displayed (Figure 8B).</p>
<p>For further information on these plots and the <code class="docutils literal notranslate"><span class="pre">.dat</span></code> files, please see the Developers notes’ information about the <strong>Contacts</strong> <a class="reference internal" href="../Tutorials%20sirahgui.html#contacts-devnotes"><span class="std std-ref">tab</span></a>.</p>
</section>
<section id="intramolecular-contacts">
<span id="contacts-intra"></span><h3>Intramolecular contacts<a class="headerlink" href="#intramolecular-contacts" title="Link to this heading"></a></h3>
<p>To calculate intramolecular contacts, the choices must be in the same molecule.</p>
<p>For the NCP trajectory, let’s designate identical “name GC” selections on both boxes (Figure 9A).</p>
<figure class="align-center" id="id19">
<a class="reference internal image-reference" href="../_images/Figure_9_SirahGui.png"><img alt="../_images/Figure_9_SirahGui.png" src="../_images/Figure_9_SirahGui.png" style="width: 80%;" />
</a>
<figcaption>
<p><span class="caption-text"><strong>Figure 9.</strong> <strong>Contacts</strong> tab settings for intramolecular contacts analyses for the selections “name GC” of the NCP system. A) Settings to contact analysis. Two selections are needed, these selections can be in the same or different molecules. Here, both selections are identical and in the same molecule. The default numbers were set to speed up the calculation. B) Run contacts calculation. Since it was selected, a distance matrix will also be calculated. Calculation progress will be displayed and can be stopped at any time. C) When the calculations are done, buttons to make the plots will become active.</span><a class="headerlink" href="#id19" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>Let’s leave the cutoff distance at default value of 8.00 Å and use a 100-frame skip (reducing the 10.000-frame long trajectory to 100 frames) (Figure 9A).</p>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>Keep in mind that the calculation will take longer if the selections have many beads or atoms or if there are a high number of frames to be processed, so be patient.</p>
</div>
<p>Let’s select the <em>Calculate Distance Matrix</em> option (Figure 9B). The matrix here is symmetric as a result of the same number of GC beads on both selections. This symmetry is expected whenever the two interacting groups are of identical sizes, which is typically the case in intramolecular contact analyses.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Regardless of the selection, only GC (for proteins), PX (for DNA), or BFO (for lipids) beads are taken into consideration in the matrix to produce a concise distance matrix. This eliminates the need to calculate several distances between selections, hence it doesn’t create large files. For further information, please see the Developers notes’ information about the “Contacts” <a class="reference internal" href="../Tutorials%20sirahgui.html#contacts-devnotes"><span class="std std-ref">tab</span></a> .</p>
</div>
<p>Click the <em>Run Contact Analysis</em> button (Figure 9B).</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The VMD output area will display the progress of the calculation. The calculation can be stopped using the “Stop” button if something goes wrong.</p>
</div>
<p>Once the calculation is complete a new folder “Contacts” is generated in the working directory. To aid in the creation of the contact plots, the <code class="docutils literal notranslate"><span class="pre">contact</span> <span class="pre">length</span></code>, <code class="docutils literal notranslate"><span class="pre">distance</span> <span class="pre">length</span></code>, <code class="docutils literal notranslate"><span class="pre">distbyframe</span></code>, <code class="docutils literal notranslate"><span class="pre">contacts</span></code>, <code class="docutils literal notranslate"><span class="pre">percentage</span></code>, and <code class="docutils literal notranslate"><span class="pre">timeline</span></code> <code class="docutils literal notranslate"><span class="pre">.dat</span></code> files will be created.</p>
<p>Buttons for creating <em>Native Contacts Conservation</em>, <em>Contact Map</em>, and <em>Distance Map By Frame</em> plots will become active once the calculation is finished (Figure 9C).</p>
<p>By clicking on the <em>Native Contacts Conservation</em> button, a plot of the conservation of the initial frame contacts between the selections during the simulation can be obtained.</p>
<p>By clicking on the <em>Contact Map</em> button, a symmetric “name GC” by “name GC” heatmap is shown in an interactive window (Figure 10). In this window, a Colormap selector can be used to alter the color of the heatmap via a drop-down menu. A variety of <a class="reference external" href="https://matplotlib.org/stable/users/explain/colors/colormaps.html">Matplotlib colormaps</a> (such as viridis, plasma, coolwarm, etc.) can be chosen to optimally highlight the contact pattern. Additionally, Matplotlib navigation (pan/zoom) is operable. Lastly, the plot can be exported at any resolution by using the “Save plot” option; just input the needed DPI number before saving.</p>
<figure class="align-center" id="id20">
<a class="reference internal image-reference" href="../_images/Figure_10_SirahGui.png"><img alt="../_images/Figure_10_SirahGui.png" src="../_images/Figure_10_SirahGui.png" style="width: 100%;" />
</a>
<figcaption>
<p><span class="caption-text"><strong>Figure 10.</strong> Contact Map plot window of the “name GC” by “name GC” matrix.</span><a class="headerlink" href="#id20" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>By clicking on the <em>Distance Map by Frame</em> button, the ‘Heat Map Viewer’ window will appear (Figure 11). A heatmap of the complete distance matrix between beads for every frame will be displayed. You can navigate among the frames or skip straight to a particular frame using a slider that is located over the plot. Similar to the “Contact map” panel, options for Matplotlib navigation and color palettes are accessible.</p>
<figure class="align-center" id="id21">
<a class="reference internal image-reference" href="../_images/Figure_11_SirahGui.png"><img alt="../_images/Figure_11_SirahGui.png" src="../_images/Figure_11_SirahGui.png" style="width: 100%;" />
</a>
<figcaption>
<p><span class="caption-text"><strong>Figure 11.</strong> Heat map viewer. A) the heatmap for the “name GC” option, meaning the entire histone octamer, from the NCP simulation. B) To enhance visibility, we present an alternative selection utilizing a single histone.</span><a class="headerlink" href="#id21" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>Additionally, a <em>Create GIF</em> button (Figure 11) is provided to generate an animated GIF depicting the distance evolution throughout the experiment (Figure 12). Clicking “Create GIF” will generate a new folder titled “GIF” within the “Contacts” folder in the working directory.</p>
<figure class="align-center" id="id22">
<a class="reference internal image-reference" href="../_images/Figure_12_SirahGui_half.gif"><img alt="../_images/Figure_12_SirahGui_half.gif" src="../_images/Figure_12_SirahGui_half.gif" style="width: 70%;" />
</a>
<figcaption>
<p><span class="caption-text"><strong>Figure 12.</strong> Animated GIF of 50 frames depicting one of the histones from the NCP simulation.</span><a class="headerlink" href="#id22" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>For further information on these plots and the .dat files, please see the Developers notes’ information about the “Contacts” <a class="reference internal" href="../Tutorials%20sirahgui.html#contacts-devnotes"><span class="std std-ref">tab</span></a>.</p>
</section>
</section>
<section id="calculating-secondary-structure-ss">
<h2>Calculating Secondary Structure (SS)<a class="headerlink" href="#calculating-secondary-structure-ss" title="Link to this heading"></a></h2>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The SS Analysis tab uses the SIRAH Tools approach to categorize secondary structure elements (Helix, Extended Beta Sheet, or Coil), hence it is exclusively compatible with SIRAH MD simulations.</p>
</div>
<p>Here let’s select the <strong>SS Analysis</strong> tab. This tab allows performing secondary structure analysis throughout a SIRAH MD simulation using the methodology described in <a class="reference external" href="https://academic.oup.com/bioinformatics/article/32/10/1568/1743152">SIRAH Tools</a>. See more details of the tab <a class="reference internal" href="../Tutorials%20sirahgui.html#ssanalysis-devnotes"><span class="std std-ref">here</span></a>.</p>
<p>For the NCP trajectory, let’s retain the default values for the “First” and “Last” fields (Figure 13A). The analysis will be conducted from the initial frame (1) to the final frame (-1). However, let’s modify the “Selection” field to the SIRAH macro “sirah_protein” and use a 10-frame skip in the trajectory (Figure 13A). This will speed up the calculations and reduce the number of frames from 10.000 to 1.000.</p>
<figure class="align-center" id="id23">
<a class="reference internal image-reference" href="../_images/Figure_13_SirahGui.png"><img alt="../_images/Figure_13_SirahGui.png" src="../_images/Figure_13_SirahGui.png" style="width: 80%;" />
</a>
<figcaption>
<p><span class="caption-text"><strong>Figure 13.</strong> <strong>SS Analysis</strong> tab settings for secondary structure of the proteins in the NCP system. A) Settings to SS analysis. Here, the SS classification was calculated for the entire simulation using the default values and the sirah_protein macro. The <em>Calculate Psi/Phi</em> was also selected. B) The VMD output shows the progress of the calculation and the summary of SS the run. C) The names of the files created during the run. D) When the calculations are done, buttons to make the plots will become active.</span><a class="headerlink" href="#id23" title="Link to this image"></a></p>
</figcaption>
</figure>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The interface allows for a selection; however, SS calculation is exclusively performed on protein structures. This selection, similar to those in other tabs, employs VMD syntax. Thus, for example, it allows for the calculation of information for particular chains within complicated protein systems.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Check out the <a class="reference external" href="https://sirahff.github.io/documentation/Tutorials%20sirahtools.html">SIRAH Tools tutorial</a> to learn more about VMD and SIRAH macros and how to use them.</p>
</div>
<p>Let’s select the <em>Calculate Psi/Phi</em> option (Figure 13A). Selecting this option will compute the PSI/PHI angles during the secondary structure assignment and generate files suitable for plotting in a Ramachandran plot.</p>
<p>Click the <em>Run SS Analysis</em> button (Figure 13A). The VMD output area will exhibit the calculation progress, and a summary of the SS will be presented upon completion of the computation (Figure 13B).
Leave the “Change Output File Names” unselected in the “Output Files” section (Figure 13C).
Once the calculation is complete a new folder “ss_analysis” is generated in the working directory. To aid in the creation of the SS plots, the <code class="docutils literal notranslate"><span class="pre">ss_by_frame.xvg</span></code>, <code class="docutils literal notranslate"><span class="pre">ss_by_res.xvg</span></code>, <code class="docutils literal notranslate"><span class="pre">ss_global.xvg</span></code>, <code class="docutils literal notranslate"><span class="pre">ss.mtx</span></code>, <code class="docutils literal notranslate"><span class="pre">phi.mtx</span></code>, and <code class="docutils literal notranslate"><span class="pre">psi.mtx</span></code> files will be created.
Buttons <em>Plot Matrix</em>, <em>Plot by Frame</em>, <em>Plot by Res</em>, and <em>Analyze Psi/Phi</em> will become active once the calculation is finished (Figure 13D).</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The <em>Analyse Psi/Phi</em> option is always available in this tab. This indicates that prior angle calculations can be utilized at any moment, eliminating the need for repeated computations.</p>
</div>
<p>By clicking on the <em>Plot Matrix</em> button, a plot utilizing the <code class="docutils literal notranslate"><span class="pre">ss.mtx</span></code> file, displaying the alterations in secondary structure of each residue throughout the simulation will be generated (Figure 14A).</p>
<figure class="align-center" id="id24">
<a class="reference internal image-reference" href="../_images/Figure_14_SirahGui.png"><img alt="../_images/Figure_14_SirahGui.png" src="../_images/Figure_14_SirahGui.png" style="width: 100%;" />
</a>
<figcaption>
<p><span class="caption-text"><strong>Figure 14.</strong> Outcomes of “Analysis” section from the <strong>SS Analysis</strong> tab where the secondary structural elements α-helix (H), extended β-sheet (E), and coil (C) are colored purple, yellow, and blue, respectively.</span><a class="headerlink" href="#id24" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>By clicking on the <em>Plot By Frame</em> button, a plot utilizing the <code class="docutils literal notranslate"><span class="pre">ss_by_frame.xvg</span> <span class="pre">file</span></code>, displaying the percentage changes of each secondary structure classification throughout the simulation will be generated (Figure 14B).</p>
<p>By clicking on the <em>Plot By Res</em> button, a plot utilizing the <code class="docutils literal notranslate"><span class="pre">ss_by_res.xvg</span> <span class="pre">file</span></code>, displaying the percentage of each secondary structure classification that each residue adopted throughout the simulation will be generated (Figure 14C).</p>
<p>By clicking on the <em>Analyze Psi/Phi</em> button, the <em>Ramachandran Plot Visualization Tool</em> window will appear (Figure 15). This interface allows for the loading of the <code class="docutils literal notranslate"><span class="pre">psi.mtx</span></code> and <code class="docutils literal notranslate"><span class="pre">phi.mtx</span></code> files via the <em>Load PSI</em> and <em>Load PHI</em> buttons, respectively (Figure 15A). A Ramachandran plot is automatically generated for the first frame (Figure 15B). You can also navigate among the frames using the frame slider or skip straight to a particular frame at the “Go to frame” option (Figure 15B).</p>
<figure class="align-center" id="id25">
<a class="reference internal image-reference" href="../_images/Figure_15_SirahGui.png"><img alt="../_images/Figure_15_SirahGui.png" src="../_images/Figure_15_SirahGui.png" style="width: 100%;" />
</a>
<figcaption>
<p><span class="caption-text"><strong>Figure 15.</strong> Ramachandran Plot Visualization Tool window. A) The window before loading the <code class="docutils literal notranslate"><span class="pre">.mtx</span></code> matrices. B) After loading the <code class="docutils literal notranslate"><span class="pre">.mtx</span></code> matrices. The Ramachandran plot of the Frame 0 is displayed with each residue as a point (orange). The overall density of the residues, using the position of the residues in the plot from all the frames, is also displayed (green areas).</span><a class="headerlink" href="#id25" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>Click on the “Show Density” button to display the density calculated for the entire matrix. Additionally, you can obtain particular information regarding the residue by hovering the mouse over a residue point (Figure 15B). Finally, select a frame and save the plot by clicking the <em>Save Plot</em> button.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Depending on your screen’s resolution, the opened window may appear truncated; merely resize it to the appropriate dimensions.</p>
</div>
<p>For further information on the files and the <em>Ramachandran Plot Visualization Tool</em>, please see the Developers notes’ information about the <strong>SS Analysis</strong> <a class="reference internal" href="../Tutorials%20sirahgui.html#ssanalysis-devnotes"><span class="std std-ref">tab</span></a> .</p>
</section>
<section id="backmapping-from-cg-to-aa">
<h2>Backmapping from CG to AA<a class="headerlink" href="#backmapping-from-cg-to-aa" title="Link to this heading"></a></h2>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The Backmapping tab uses the SIRAH Tools approach, hence it is exclusively compatible with SIRAH MD simulations. Currently, backmapping libraries contain instructions for solute (proteins, DNA, metal ions, and glycans).</p>
</div>
<p>Here let’s select the <strong>Backmapping</strong> tab. This tab allows retrieving pseudo-atomistic information from the SIRAH CG model. The atomistic positions are built on a by-residue basis following the geometrical reconstruction (internal coordinates) to AA model. See more details of the tab <a class="reference internal" href="../Tutorials%20sirahgui.html#backmapping-devnotes"><span class="std std-ref">here</span></a>.</p>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>In the backmapping process, a structure minimization is performed using the <a class="reference external" href="https://pubs.acs.org/doi/10.1021/acs.jcim.3c01153">AmberTools</a> modules, therefore it is necessary to have configured the <code class="docutils literal notranslate"><span class="pre">$AMBERHOME</span></code> environment properly.</p>
<p>Optionally you can install AmberTools via conda:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>conda<span class="w"> </span>install<span class="w"> </span>-c<span class="w"> </span>conda-forge<span class="w"> </span><span class="nv">ambertools</span><span class="o">=</span><span class="m">23</span>
</pre></div>
</div>
<p>or more recently option:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>conda<span class="w"> </span>install<span class="w"> </span>dacase::ambertools-dac<span class="o">=</span><span class="m">25</span>
</pre></div>
</div>
<p>Remember to install it in the same Python environment created for SIRAH Tools GUI.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>SIRAH Tools GUI automatically detects if the <code class="docutils literal notranslate"><span class="pre">$AMBERHOME</span></code> environment is set in the system path (Figure 16A).</p>
</div>
<p>For the NCP trajectory, let’s retain the default values for the “First” and “Last” fields (Figure 16B). The analysis will be conducted from the initial frame (1) to the final frame (-1), meaning all frames will be used. However, let’s set a 5.000-frame skip in “Each” field to the trajectory (Figure 16B). This will bring the number of frames from 10.000 to 2.</p>
<figure class="align-center" id="id26">
<a class="reference internal image-reference" href="../_images/Figure_16_SirahGui.png"><img alt="../_images/Figure_16_SirahGui.png" src="../_images/Figure_16_SirahGui.png" style="width: 100%;" />
</a>
<figcaption>
<p><span class="caption-text"><strong>Figure 16.</strong> <strong>Backmapping</strong> tab settings for the NCP system when <code class="docutils literal notranslate"><span class="pre">$AMBERHOME</span></code> is set correctly. A) The <code class="docutils literal notranslate"><span class="pre">$AMBERHOME</span></code> environment was automatically detected and minimization using sander can be performed. B) In addition to applying a 5000-frame skip, all Basic Options and Advanced Options were retained at their default configurations within the SIRAH Tools. C) The VMD output shows the progress of the calculation. D) The <em>Open Backmap in VMD</em> button launches VMD with the <code class="docutils literal notranslate"><span class="pre">backmap.pdb</span></code> file. E) VMD windows with the <code class="docutils literal notranslate"><span class="pre">backmap.pdb</span></code> file.</span><a class="headerlink" href="#id26" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>Given that the <code class="docutils literal notranslate"><span class="pre">$AMBERHOME</span></code> environment is set up, minimization will be conducted with the default settings of the SIRAH Tools. Thus, click the <em>Run Backmap</em> button (Figure 16B). The VMD output area will exhibit the calculation progress (Figure 16C).</p>
<p>Upon completion of the calculation, a new folder titled “backmapping” is created in the working directory, containing a PDB or multi-PDB file entitled <code class="docutils literal notranslate"><span class="pre">backmap.pdb</span></code>.
A <em>Open Backmap in VMD</em> will become activated (Figure 16D). This will open the generated PDB file in VMD (Figure 16E).</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Always check both the original CG trajectory and the backmapping output to identify out-of-the-ordinary behavior and adjust arguments accordingly.
Keep in mind that the minimized structures sometimes may differ from the CG trajectory due to the combination of all-atom minimization algorithms, number of cycles, cutoffs, etc.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>In instances where AmberTools is unavailable, the nomin option, in the Advanced options section, can be used to disable the minimization step. Consequently, you can minimize backmapped outputs by utilizing other software/force fields outside of VMD. Keep in mind that hydrogen atoms won’t be added to the structures if the minimization step is skipped.</p>
</div>
<p>Let us examine a scenario in which the <code class="docutils literal notranslate"><span class="pre">$AMBERHOME</span></code> environment is not configured (Figure 17A).</p>
<figure class="align-center" id="id27">
<a class="reference internal image-reference" href="../_images/Figure_17_SirahGui.png"><img alt="../_images/Figure_17_SirahGui.png" src="../_images/Figure_17_SirahGui.png" style="width: 100%;" />
</a>
<figcaption>
<p><span class="caption-text"><strong>Figure 17.</strong> <strong>Backmapping</strong> tab settings for the NCP system when <code class="docutils literal notranslate"><span class="pre">$AMBERHOME</span></code> is not set correctly or not available. A) The <code class="docutils literal notranslate"><span class="pre">$AMBERHOME</span></code> environment was not detected and minimization using sander can not be performed. B) Configuration of the Basic Options via the Frames field. Since the “Frames” field has been established, the “First”, “Last”, and “Each” choices will be disregarded in the calculation. C) Configuration of the Advanced Options. Since the “nomin” option was selected, the other options, related to sander parameters will be disregarded in the calculation. D) <em>Run Backmap</em> button. E) The <em>Open Backmap in VMD</em> button launches VMD with the <code class="docutils literal notranslate"><span class="pre">backmap.pdb</span></code> file.</span><a class="headerlink" href="#id27" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>Rather than utilizing the complete trajectory, let us configure the Frames option (Figure 17B).  This option requires a list of frames devoid of commas or dashes. Use “1 2 3” to obtain the backmapping of the initial three frames.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The First/Last and Frames options are mutually exclusive. If Frames is specified, the First/Last and Each options are not used.</p>
</div>
<p>Let’s change the “Outname” from “backmap” to “backmap123” (Figure 17B).</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Changing the “Outname” prevents the overwriting of previously backmapped frames.</p>
</div>
<p>To access the <em>nomin</em> option, use the <em>Advanced Options</em> radio button (Figure 17C). The <em>Advanced Options</em> includes additional settings, primarily associated with the minimization process.  As we are utilizing the “nomin” option, let us keep the other options as they are.</p>
<p>Click the <em>Run Backmap</em> button (Figure 17D) and examine the <code class="docutils literal notranslate"><span class="pre">backmap123.pdb</span></code> file in PDB by selecting <em>Open Backmap in VMD</em> (Figure 17E).</p>
<p>For further information on this tab options, please see the <a class="reference internal" href="../Tutorials%20sirahgui.html#backmapping-devnotes"><span class="std std-ref">Developers notes’</span></a> information about the Backmapping .</p>
</section>
</section>
<section id="developers-notes">
<h1>Developers notes<a class="headerlink" href="#developers-notes" title="Link to this heading"></a></h1>
<p>Here, we provide further technical information regarding each SIRAH Tools GUI tab as well as details on identified issues and limitations.</p>
<section id="general-information">
<h2>General Information<a class="headerlink" href="#general-information" title="Link to this heading"></a></h2>
<p>This section offers information that is identical or analogous to all SIRAH Tools GUI tabs:</p>
<ul class="simple">
<li><p>The SIRAH Tools GUI works with VMD in text mode; therefore, it can be used on any system that can be loaded in VMD.</p></li>
</ul>
<ul class="simple">
<li><p>The GUI automatically detects if VMD is set in the system path, this is essential for the correct operation of SIRAH Tools GUI. If VMD is not set up correctly, a warning will be displayed and the tabs will be disabled.</p></li>
</ul>
<ul class="simple">
<li><p>SIRAH Tools GUI uses VMD syntax selections (e.g. name, resname, resid, etc.) or VMD/SIRAH macros in all selection boxes. Check out the <a class="reference external" href="https://sirahff.github.io/documentation/Tutorials%20sirahtools.html">SIRAH Tools tutorial</a> to learn more about VMD and SIRAH macros and how to use them.</p></li>
</ul>
<ul class="simple">
<li><p>Use caution regarding excessively big or heavy trajectories. To minimize computer memory usage, SIRAH Tools GUI terminates VMD after completing an analysis on a tab. This indicates that if the analysis requires repetition or the user navigates to a different tab, the trajectory file will be reloaded in both scenarios. Therefore, we advise utilizing the skip frame options in the tabs (when available) or reducing the system size (for example, by eliminating solvent molecules) to decrease the loading time.</p></li>
</ul>
<ul class="simple">
<li><p>The VMD output area presents details regarding the VMD execution alongside the terminal window in which the SIRAH Tools GUI was initiated. Consequently, any issue or malfunction within SIRAH Tools GUI will show up in these locations.</p></li>
</ul>
<ul class="simple">
<li><p>Any external plotting software or script should be able to use the files in text format generated from the conducted analysis.</p></li>
</ul>
<ul class="simple">
<li><p>The plots produced by the SIRAH Tools GUI, which feature simulation time as an axis, are on the microsecond timeframe to align with the expected simulation duration of microseconds for the SIRAH force field.</p></li>
</ul>
<ul class="simple">
<li><p>Complex systems that contain an excessive number of components might lead to plots that are densely packed.</p></li>
</ul>
<ul class="simple">
<li><p>Depending on your screen’s resolution, the GUI window may appear truncated; merely resize it to the appropriate dimensions.</p></li>
</ul>
<ul class="simple">
<li><p>The <strong>SS Analysis</strong> and <strong>Backmapping</strong> tabs use the SIRAH Tools approach, hence it is <strong>exclusively compatible with SIRAH MD simulations</strong>.</p></li>
</ul>
</section>
<section id="load-files">
<span id="loadfiles-devnotes"></span><h2>Load Files<a class="headerlink" href="#load-files" title="Link to this heading"></a></h2>
<p>The <strong>Load Files</strong> tab allows loading AMBER, GROMACS, and NAMD simulation topologies and trajectories compatible with SIRAH force field MD simulations (Figure 18).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The SIRAH Tools GUI works with VMD in text mode; therefore, it can be used on any system that can be loaded in VMD.</p>
</div>
<figure class="align-center" id="id28">
<a class="reference internal image-reference" href="../_images/Figure_18_SirahGui.png"><img alt="../_images/Figure_18_SirahGui.png" src="../_images/Figure_18_SirahGui.png" style="width: 100%;" />
</a>
<figcaption>
<p><span class="caption-text"><strong>Figure 18.</strong> The <strong>Load Files</strong> tab. Setting up any subsequent analysis with the SIRAH Tools GUI begins with the “Load Files” tab.</span><a class="headerlink" href="#id28" title="Link to this image"></a></p>
</figcaption>
</figure>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Windows may not support AMBER trajectories in NetCDF format (limited by VMD).</p>
</div>
<p>Optionally, the user can load a reference structure (pdb or gro format are supported) to be used for RMSD and RMSF calculations. In addition, the time step and step between frames boxes are set to the default values used in the SIRAH tutorials. If these values have been changed, users must set them to the right values used in their simulation to make sure the analyses and plots are performed correctly.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The GUI automatically detects if VMD is set in the system path, this is essential for the correct operation of SIRAH Tools GUI. If VMD is not set up correctly, a warning will be displayed and the tabs will be disabled.</p>
</div>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>Use caution regarding excessively big or heavy trajectories. To minimize computer memory usage, SIRAH Tools GUI terminates VMD after completing an analysis on a tab. This indicates that if the analysis requires repetition or the user navigates to a different tab, the trajectory file will be reloaded in both scenarios. Therefore, we advise utilizing the skip frame options in the tabs (when available) or reducing the system size (for example, by eliminating solvent molecules) to decrease the loading time.</p>
</div>
</section>
<section id="analysis">
<span id="analysis-devnotes"></span><h2>Analysis<a class="headerlink" href="#analysis" title="Link to this heading"></a></h2>
<p>The <strong>Analysis</strong> tab allows several types of MD simulation analysis (Figure 19). Basic (RMSD, RMSF, and Radius of Gyration (RGYR) and advanced analyses (SASA, measuring the distances between two beads, and Radial Distribution Functions (RDF) are available.</p>
<p>The number of selection entries that the user must provide is where basic and advanced analysis diverge. While up to two entries can be made for advanced analysis, only one selection entry is required for basic analysis. VMD syntax selections (e.g. name, resname, resid, etc.) or VMD/SIRAH macros must be entered in all selection boxes.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Check out the <a class="reference external" href="https://sirahff.github.io/documentation/Tutorials%20sirahtools.html">SIRAH Tools tutorial</a> to learn more about VMD and SIRAH macros and how to use them.</p>
</div>
<figure class="align-center" id="id29">
<a class="reference internal image-reference" href="../_images/Figure_19_SirahGui.png"><img alt="../_images/Figure_19_SirahGui.png" src="../_images/Figure_19_SirahGui.png" style="width: 100%;" />
</a>
<figcaption>
<p><span class="caption-text"><strong>Figure 19.</strong> The “Analysis” tab performs and plots common MD analysis routines.</span><a class="headerlink" href="#id29" title="Link to this image"></a></p>
</figcaption>
</figure>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The “Analyze” button will only be enabled if one or more options are selected in either the Basic Analysis or Advanced Analysis sections, but you are not required to check every checkbox.</p>
</div>
<p>The following information is used to calculate Basic Analysis options in SIRAH Tools GUI:</p>
<ul class="simple">
<li><p><strong>RMSD:</strong> the VMD measure command is used to calculate RMSD (<a class="reference external" href="http://www-s.ks.uiuc.edu/Research/vmd/vmd-1.9.1/ug/node136.html">see VMD measure</a> ). Prior to RMSD calculation, each frame of the trajectory will be superimposed to the first frame or the reference structure based on the selected syntax. Thus, all beads or atoms of the selection will be rotated and translated to fit a structure (first or reference) to minimize RMSD. There isn’t currently a nofit option.</p></li>
</ul>
<ul class="simple">
<li><p><strong>RMSF:</strong> the VMD measure command is used to calculate RMSF (<a class="reference external" href="http://www-s.ks.uiuc.edu/Research/vmd/vmd-1.9.1/ug/node136.html">see VMD measure</a> ). This command returns the root mean square position fluctuation for each selected bead or atom in the selected frames. Prior to RMSF calculation, each frame of the trajectory will be superimposed to the first frame or the reference structure based on the selected syntax. Thus, all beads or atoms of the selection will be rotated and translated to fit a structure (first or reference). There isn’t currently a nofit option. The output file is provided based on bead or atom numbers.</p></li>
</ul>
<ul class="simple">
<li><p><strong>RGYR:</strong> the VMD measure command is used to calculate RGYR (<a class="reference external" href="http://www-s.ks.uiuc.edu/Research/vmd/vmd-1.9.1/ug/node136.html">see VMD measure</a> ). This command returns the radius of gyration of atoms in the selection. The calculation is done for all frames.</p></li>
</ul>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>It is necessary to fill out both selections in the <em>Advanced Analysis</em>.</p>
</div>
<p>The following information is used to calculate <em>Advanced Analysis</em> options in SIRAH Tools GUI:</p>
<ul class="simple">
<li><p><strong>SASA:</strong> the VMD measure command is used to calculate SASA (<a class="reference external" href="http://www-s.ks.uiuc.edu/Research/vmd/vmd-1.9.1/ug/node136.html">see VMD measure</a>). So, a selection in VMD syntax (e.g. name, resname, resid, etc.) or VMD/SIRAH macro is needed to calculate SASA (Selection2). There is, however, a restrictedsel flag in the command as well, implemented here as the second selection (Selection3). This flag limits the calculation to the solvent-accessible points close to this restricted region. This keeps protein voids or pockets inside the protein from affecting the surface area values. For the SIRAH Tools GUI, the restrictedsel flag is not used if Selection2 and Selection3 are the same. If they are different, however, Selection3 will be used as the restrictedsel flag. Refer to the <a class="reference external" href="https://sirahff.github.io/documentation/Tutorials%20analysis.html#sasa">Basic Analyses VMD tutorials SASA section</a> .</p></li>
</ul>
<ul class="simple">
<li><p><strong>RDF:</strong> the VMD measure command is used to calculate Radial Distribution Function (RDF) (<a class="reference external" href="http://www-s.ks.uiuc.edu/Research/vmd/vmd-1.9.1/ug/node136.html">see VMD measure</a>). Given that typical RDF is calculated between two items, both Selection2 and Selection3 must be defined and have to reference the same molecule. However, Selections 2 and 3 may be the same or dissimilar. Very complex distribution functions can be calculated thanks to the strength of VMD’s selection language syntax. In addition, here, the maximum radius to calculate RDF is set to 12 Å.</p></li>
</ul>
<ul class="simple">
<li><p><strong>Distance:</strong> to determine the distance between the selections, SIRAH Tools GUI computes their center of mass using the VMD measure command (<a class="reference external" href="http://www-s.ks.uiuc.edu/Research/vmd/vmd-1.9.1/ug/node136.html">see VMD measure</a>). Therefore, only two distinct selections—for example, two distinct atoms or beads, two distinct residues, two distinct molecules, etc.—can be used to calculate the “Distance” option. If they are identical molecules, residues, beads, or atoms, meaning using the same selection in both selection boxes, will result in a zero value to all frames.</p></li>
</ul>
<p>The “Generate Report” section also offers two options: if the “Generate PDF report” option is chosen, a PDF with all plots of the chosen analyses will be created. If the “rmsf into pdb bfactor” is checked, a PDB file with the RMSF values in the Beta factor column is created using the first frame coordinates.</p>
<p>There are further options in the “Parameters” section. While the “Skip” option relates to skipping frames when performing an analysis, the “Time Step” and “Step Between Frames”, which are retrieved from the “Load Files” page, can also be changed here. These parameters should be entered properly since they will have an impact on the plot labels.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If different values of “Time step” and “Step between frames” have been applied in the MD simulation, users must set them to the appropriate values used in their simulation to make sure the analyses and plots are performed correctly.</p>
</div>
<p>The reference file is yet another bit of data that may be obtained from “Load Files”. The RMSD and RMSF analyses will be performed using the reference file, if one was loaded.</p>
<p>Additionally, it is possible to set the “Solvent Radius (SRAD)” for SASA calculations. SRAD is the probe radius utilized for the SASA analysis in VMD. The default value chosen here (2.1 Å) is the one used in CG simulations in SIRAH.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The VMD output area displays information about the VMD execution (as in a terminal window). Thus, any problem or error within the VMD will appear here.</p>
</div>
<p>In the given working directory, a new “Analysis” directory will store all generated files, plots, reports, and PDB files.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The name of the files consists of a ‘root’ according to the analysis concatenated with the selection. The way that the files are named facilitates the analysis of various selections. New files are created by different selections, whereas files are rewritten over if the same selection is made again. Nevertheless, a pop-up box will question if the user wants to rewrite the files.</p>
</div>
</section>
<section id="contacts">
<span id="contacts-devnotes"></span><h2>Contacts<a class="headerlink" href="#contacts" title="Link to this heading"></a></h2>
<p>The <strong>Contacts</strong> tab allows the analysis of contacts between two selections using a cutoff distance as a criterion (Figure 20). It produces native contact data, contacts and distance maps. Intermolecular or intramolecular contacts can be calculated depending on the selection. In addition, the “Calculate Distance Matrix” option allows to compute a distance matrix of each pair of beads for each frame of the simulation.</p>
<figure class="align-center" id="id30">
<a class="reference internal image-reference" href="../_images/Figure_20_SirahGui.png"><img alt="../_images/Figure_20_SirahGui.png" src="../_images/Figure_20_SirahGui.png" style="width: 100%;" />
</a>
<figcaption>
<p><span class="caption-text"><strong>Figure 20.</strong>  The “Contacts” tab performs and plots different contact analysis routines.</span><a class="headerlink" href="#id30" title="Link to this image"></a></p>
</figcaption>
</figure>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the selection contains many atoms or if it has too many frames, the distance matrix calculation can be slow and demanding.</p>
</div>
<p>In the “Settings” section, two selections in VMD syntax are needed. When Selection1 and Selection2 are in the same molecule, intramolecular contacts are calculated. When Selection1 and Selection2 are in different molecules, intermolecular contacts are calculated. The default distance cutoff value to determine a contact is 8.00 Å, generally used to analyze SIRAH simulations. The “Skip” option will decrease the number of frames of the trajectory to be processed by the value chosen by the user. In order to improve the calculation for longer trajectories, the default value is 100.</p>
<p>In the “Run” section, a “Calculate Distance Matrix” option can be found. If this option is enabled, a distance matrix of the selections will be calculated for every frame of the trajectory. Depending on the number of the frames this calculation can be quite slow.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Regardless of the selection, only GC (for proteins), PX (for DNA), or BFO (for lipids) beads are taken into consideration in the matrix to produce a concise distance matrix. This eliminates the need to calculate several distances between selections, hence it doesn’t create large files.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The VMD output area will display the progress of the calculation. The calculation can be stopped using the “Stop” button if something goes wrong.</p>
</div>
<p>The “Analysis” section will be enabled once the calculation is finished. Three buttons will be available:</p>
<ol class="arabic simple">
<li><p><em>Native Contacts Conservation</em> that plots the conservation of the first frame contacts between the selections during the simulation. The native contact conservation plot is a line graph with the simulation time on the X-axis and the percentage of contacts on the Y-axis. A secondary Y-axis representing the number of contacts found is also illustrated. This graph depicts three elements:</p></li>
</ol>
<ul class="simple">
<li><p>The percentage of contact conservation during the simulation (blue line), utilizing the initial frame as the reference point. This approach involves dividing the quantity of conserved contacts identified in a frame by the quantity of conserved contacts identified in the reference frame;</p></li>
<li><p>The percentage of contact accuracy during the simulation (orange line). This calculation involves dividing the quantity of conserved contacts identified in a frame by the entire quantity of contacts present in that same frame;</p></li>
<li><p>The number of contacts that yields the overall amount of contacts for each frame (green line). The defined cutoff distance is used to determine all beads or atoms that are within contact distance of the selections.</p></li>
</ul>
<ol class="arabic simple" start="2">
<li><p><em>Contact Map</em> that plots a heatmap with the total interaction time, in simulation time percentage, between the residues of the selections during the simulation.</p></li>
</ol>
<ul class="simple">
<li><p>The contact map heatmap utilizes data from all contacts within the specified cutoff to compute an average residue-by-residue persistence duration of the contacts in the trajectory. Based on the selection, several beads or atoms of a single residue may interact with numerous beads or atoms of another residue; therefore, to eliminate repetition, only the interacting pair with the highest frame count is utilized in the plot. However, a file with the information of all the interacting pairs is created to be used by the user. In addition, a standard Matplotlib navigation (pan/zoom) is presented, showcasing various accessible color combinations.</p></li>
</ul>
<ol class="arabic simple" start="3">
<li><p><em>Distance Map by Frame</em> that plots the distance between the selections as a heatmap for each frame, independent of the cutoff distance. In this analysis, users can move through the frames, save the plot, and make a gif in the pop-up window that appears.</p></li>
</ol>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">vecdist</span></code> command of VMD is used to calculate the distance for the distance matrix, where the two vectors represent the coordinates of two selections. It is recommended to utilize selections that yield a singular bead or atom per residue for this plot. When dealing with selections that included several beads or atoms per residue, the computation performed for each frame led to prolonged calculations, elevated memory consumption, and huge files. Therefore, if a selection has many beads or atoms per residue (such as in the macro sirah_protein or protein), the TCL script (<code class="docutils literal notranslate"><span class="pre">/TCL/contacts_distance.tcl</span></code>) will automatically select one backbone bead (<code class="docutils literal notranslate"><span class="pre">GC,</span> <span class="pre">PX</span> <span class="pre">or</span> <span class="pre">BFO</span></code>) or atom (<code class="docutils literal notranslate"><span class="pre">CA,</span> <span class="pre">P</span></code>) for the selection. This decision enhances visualization, accelerates computation, and eliminates the necessity for generating large files.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To generate an animated GIF of the distance heatmap, select the “Create GIF” button in the Matplotlib window. You will be required to input the starting and ending frame numbers, the DPI for each frame image, and indicate whether to delete the individual frame images after the GIF has been created. The tool will produce all needed images and compile them into a GIF within the new ‘Contacts/GIF’ folder in your working directory. If you opt to retain the single-frame files, they remain in that directory alongside to the GIF.</p>
</div>
<p>Once the calculation is complete a new folder “Contacts” is generated in the working directory. To aid in the creation of the contact plots, the “contact length”, “distance length”, “distbyframe”, “contacts”, “timeline’, and “percentage” <code class="docutils literal notranslate"><span class="pre">.dat</span></code> files will be created. A description of the content of each file is provided below:</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">contact</span> <span class="pre">length</span></code> and <code class="docutils literal notranslate"><span class="pre">distance</span> <span class="pre">length</span></code> files contain the dimensions of the matrix and the information on the selections for the contact and distance heatmaps.</p></li>
</ul>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">contacts</span></code> file contains a general summary of the native contact conservation, accuracy, and total number of contacts from the simulation.</p></li>
</ul>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">timeline</span></code> file summarizes the conservation of native contacts, accuracy, and the total number of contacts for each frame, categorizing them as either native or non-native within the specified cutoff for each frame.</p></li>
</ul>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">distbyframe</span></code> file contains a distance matrix for each analyzed frame with the distance between every pair of selections.</p></li>
</ul>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">percentage</span></code> file contains the information on the percentage of duration of all contacts within the defined cutoff from the simulation. To ensure that all contacts are recorded in the file, the information is provided utilizing the residues and the beads (atoms) for each contacting pair.</p></li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Any external plotting software or script should be able to use these <code class="docutils literal notranslate"><span class="pre">.dat</span></code> files.</p>
</div>
</section>
<section id="ss-analysis">
<h2>SS Analysis<a class="headerlink" href="#ss-analysis" title="Link to this heading"></a></h2>
<div class="admonition important" id="ssanalysis-devnotes">
<p class="admonition-title">Important</p>
<p>The SS Analysis tab uses the SIRAH Tools approach to categorize secondary structure elements (Helix, Extended Beta Sheet, or Coil), hence it is exclusively compatible with SIRAH MD simulations.</p>
</div>
<p>The <strong>SS Analysis</strong> tab allows the classification and analysis of secondary structure elements using the methodology described in <a class="reference external" href="https://academic.oup.com/bioinformatics/article/32/10/1568/1743152">SIRAH Tools</a> (Figure 21). It classifies proteins in a SIRAH MD simulation into α-helix (H), extended β-sheet (B), or Coil (C). Additionally, it computes PSI/PHI angles that can be illustrated in a Ramachandran plot.</p>
<figure class="align-center" id="id31">
<a class="reference internal image-reference" href="../_images/Figure_21_SirahGui.png"><img alt="../_images/Figure_21_SirahGui.png" src="../_images/Figure_21_SirahGui.png" style="width: 100%;" />
</a>
<figcaption>
<p><span class="caption-text"><strong>Figure 21.</strong>  The <strong>SS Analysis</strong> tab performs and plots SS content for SIRAH MD simulations.</span><a class="headerlink" href="#id31" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>Users can select a frame interval for calculating the secondary structure from the trajectory. By default, the computation is performed from the initial frame (1) to the final frame (-1) of the trajectory. Nonetheless, any numerical interval may be utilized. The “Each” option is similar to the “Skip” option in other tabs and will decrease the number of frames of the trajectory to be processed by the value chosen by the user. The default value is 1, hence no frame skipping occurs.</p>
<p>The interface also enables a selection for the calculation; by default, the entire system is selected. This selection, similar to the other tabs, employs VMD syntax or SIRAH Tools Macros.</p>
<p>The CG backbone torsional angles PSI and PHI can be computed together with the secondary structure from the trajectory by activating the “Calculate Psi/Phi” option. This will generate two matrices and files, one for PSI (<code class="docutils literal notranslate"><span class="pre">psi.mtx</span></code>) and one for PHI (<code class="docutils literal notranslate"><span class="pre">phi.mtx</span></code>), including the angle values of each residue across all frames within the selected interval. The generated PSI and PHI files are suitable for a Ramachandran plot.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The CG PSI/PHI angles are calculated using the transformations specified in <a class="reference external" href="https://pubs.acs.org/doi/abs/10.1021/acs.jctc.9b00006">Machado et al</a> to facilitate comparison with canonical secondary structure elements in the atomistic Ramachandran plot. This ensures that the torsional energy landscape is represented in the same AA geometrical space. For additional details, check <a class="reference external" href="https://pubs.acs.org/doi/abs/10.1021/acs.jctc.9b00006">Machado et al</a>.</p>
</div>
<p>In the Output Files section, the name of each file to be generated can be modified. This reduces the possibility of overwriting previously produced files.</p>
<p>The <em>Run SS Analysis</em> button will examine all the established parameters and execute the SS content analysis.</p>
<p>The VMD output area will display the progress of the calculation. Upon completion of the calculation, the “ss_analysis” folder is created in the working directory, containing the files: <code class="docutils literal notranslate"><span class="pre">ss_by_frame.xvg</span></code>, <code class="docutils literal notranslate"><span class="pre">ss_by_res.xvg</span></code>, <code class="docutils literal notranslate"><span class="pre">ss_global.xvg</span></code>, <code class="docutils literal notranslate"><span class="pre">ss.mtx</span></code>, and if the Phi/Psi analysis option was enabled, the files <code class="docutils literal notranslate"><span class="pre">phi.mtx</span></code> and <code class="docutils literal notranslate"><span class="pre">psi.mtx</span></code> are additionally produced.</p>
<p>The “Analysis” section buttons will be enabled once the files are created. Four buttons will be available:</p>
<ol class="arabic simple">
<li><p><strong>Plot matrix</strong> that plots the <code class="docutils literal notranslate"><span class="pre">ss.mtx</span></code>. The <code class="docutils literal notranslate"><span class="pre">ss.mtx</span></code> file encompasses a matrix that illustrates the variation in the SS of each residue throughout the simulation. This plot displays three colors according to the SS classification: purple for H, yellow for B, and cyan for C.</p></li>
<li><p><strong>Plot by frame</strong> that plots the <code class="docutils literal notranslate"><span class="pre">by_frame.mtx</span></code>. The <code class="docutils literal notranslate"><span class="pre">by_frame.mtx</span></code> file encompasses the percentage changes of each SS content throughout the simulation. This plot is a line plot, displaying three colors according to the SS classification: purple for H, yellow for B, and cyan for C.</p></li>
<li><p><strong>Plot by Res</strong> that plots the <code class="docutils literal notranslate"><span class="pre">ss_by_res.mtx`</span></code>. The <code class="docutils literal notranslate"><span class="pre">ss_by_res.mtx</span></code> file encompasses the percentage of each SS classification that each residue adopted throughout the simulation. This plot will display three colors according to the SS classification: purple for H, yellow for B, and cyan for C.</p></li>
</ol>
<p>“Analyze Psi/Phi” launches the “Ramachandran Plot Visualization Tool” interface (Figure 22). This interface allows for the loading of the <code class="docutils literal notranslate"><span class="pre">psi.mtx</span></code> and <code class="docutils literal notranslate"><span class="pre">phi.mtx</span></code> files via the “Load PSI” and “Load PHI” buttons, respectively. A Ramachandran plot is automatically generated to all chosen frames and can be iterated by using the “Frame” slider or “Go to frame” option.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The “Analyse Psi/Phi” option is always available in this tab. This indicates that prior angle calculations can be utilized at any moment, eliminating the need for repeated computations.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">ss_global.xvg</span></code> file is not plotted since it only shows the overall percentages and standard deviation of H, E, and C of the entire simulation.</p>
</div>
<p>The “Ramachandran Plot Visualization Tool” allows for the loading of the <code class="docutils literal notranslate"><span class="pre">psi.mtx</span></code> and <code class="docutils literal notranslate"><span class="pre">phi.mtx</span></code> files via the “Load PSI” and “Load PHI” buttons, respectively (Figure 22A). A Ramachandran plot is automatically generated for the first frame (Figure 22B), however plots are created for all frames. The “Frame” slider or the “Go to frame” option can help navigate among the frames. The “Show Density” button displays the density computed for the full matrix, but the “Hide Ramach” option conceals the residue points in the plot. Histogram buttons, “Histogram per Frame” and “Histogram per Residue”, allow the creation of histograms for each frame or for a specific residue, respectively. Additionally, the “Ramachandran per residue’ button displays the angles of a specific residue in the Ramachandran geometrical space.</p>
<figure class="align-center" id="id32">
<a class="reference internal image-reference" href="../_images/Figure_22_SirahGui.png"><img alt="../_images/Figure_22_SirahGui.png" src="../_images/Figure_22_SirahGui.png" style="width: 100%;" />
</a>
<figcaption>
<p><span class="caption-text"><strong>Figure 22.</strong> Ramachandran Plot Visualization Tool window. A) The window before loading the <code class="docutils literal notranslate"><span class="pre">.mtx</span></code> matrices. B) After loading the .mtx matrices. The Ramachandran plot of the Frame 0 is displayed with each residue as a point (orange). The overall density of the residues, using the position of the residues in the plot from all the frames, is also displayed (green areas).</span><a class="headerlink" href="#id32" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>Positioning the mouse over a residue point reveals specific information about the residue on the right side of the “Ramachandran Plot Visualization Tool”. Also on the right side, “Save Plot” and “Reset” buttons are found to save the Ramachandran plot for a frame and return the tool to its initial state, respectively.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Depending on your screen’s resolution, the opened window may appear truncated; merely resize it to the appropriate dimensions.</p>
</div>
</section>
<section id="backmapping">
<h2>Backmapping<a class="headerlink" href="#backmapping" title="Link to this heading"></a></h2>
<div class="admonition important" id="backmapping-devnotes">
<p class="admonition-title">Important</p>
<p>The <strong>Backmapping</strong> tab uses the SIRAH Tools approach, hence it is exclusively compatible with SIRAH MD simulations. Currently, backmapping libraries contain instructions for solute (proteins, DNA, metal ions, and glycans).</p>
</div>
<p>The <strong>Backmapping</strong> tab allows retrieving pseudo-atomistic information from the SIRAH CG model (Figure 23). The atomistic positions are built on a by-residue basis following the geometrical reconstruction (internal coordinates) to AA model. Bond distances and angles are derived from rough organic chemistry considerations stored in backmapping libraries. Next, the structures from the initial stage are protonated and minimized with the atomistic force field ff14SB within the tleap module of AmberTools. A PDB or multi-PDB file entitled backmap.pdb will be created at the end of the calculation.</p>
<figure class="align-center" id="id33">
<a class="reference internal image-reference" href="../_images/Figure_23_SirahGui.png"><img alt="../_images/Figure_23_SirahGui.png" src="../_images/Figure_23_SirahGui.png" style="width: 100%;" />
</a>
<figcaption>
<p><span class="caption-text"><strong>Figure 23.</strong> The “Backmapping” tab performs backmapping for SIRAH MD simulations.</span><a class="headerlink" href="#id33" title="Link to this image"></a></p>
</figcaption>
</figure>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>SIRAH Tools GUI automatically detects if the <code class="docutils literal notranslate"><span class="pre">$AMBERHOME</span></code> environment is set in the system path (Figure 23). If the <code class="docutils literal notranslate"><span class="pre">$AMBERHOME</span></code> environment is not correctly configured, the structure minimization in the backmapping process cannot be executed, as it relies on AmberTools modules. The backmapping can still be done using the “nomin” option in the Advances Options section (Figure 23). Consequently, these structures can be minimized by utilizing other software/force fields outside of VMD.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Keep in mind that hydrogen atoms won’t be added to the structures if the minimization step is skipped.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Optionally you can install AmberTools via conda (without MPI and CUDA support):</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>conda<span class="w"> </span>install<span class="w"> </span>-c<span class="w"> </span>conda-forge<span class="w"> </span><span class="nv">ambertools</span><span class="o">=</span><span class="m">23</span>
</pre></div>
</div>
</div></blockquote>
<p>or more recently option:</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>conda<span class="w"> </span>install<span class="w"> </span>dacase::ambertools-dac<span class="o">=</span><span class="m">25</span>
</pre></div>
</div>
</div></blockquote>
</div>
<p>Remember to install it in the same Python environment created for SIRAH Tools GUI. This should be enough to configure AmberTools for compatibility with the SIRAH Tools GUI.</p>
<p>In the Basic Options section, users can select a frame interval for backmapping structures from the trajectory. By default, the computation is performed from the initial frame (1) to the final frame (-1) of the trajectory. Nonetheless, any numerical interval may be utilized. The “Each” option is similar to the “Skip” option in other tabs and will decrease the number of frames of the trajectory to be processed by the value chosen by the user. The default value is 100, hence the number of trajectory frames will be divided by 100. However, any numerical value may be used.</p>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>Keep in mind that the calculation will take longer if there are too many elements to backmap or if there are a high number of frames to be processed, so be patient.</p>
</div>
<p>A list of specific frames can also be used in the “Frames” option. The list of frames needs to be devoid of commas or dashes, like “1 2 3”.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The First/Last and Frames options are mutually exclusive. If Frames is specified, the First/Last and Each options are not used.</p>
</div>
<p>In the Outname option, the name of the output file to be generated can be modified. The default name is “backmap”.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Changing the “Outname” prevents the overwriting of previously backmapped frames.</p>
</div>
<p>In Advanced Options section, you could set options related to the minimization of the backmapped frames:</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>nomin:</strong> Option to avoid minimizing the system;</p></li>
<li><p><strong>mpi:</strong> MPI processes to use during minimization, default 1;</p></li>
<li><p><strong>CUDA:</strong> Flag to use pmemd.cuda, sets GBSA on, cutoff to 999 and no MPI;</p></li>
<li><p><strong>GBSA:</strong> Flag to use implicit solvation GBSA (igb=1), default off (igb=0);</p></li>
<li><p><strong>cutoff:</strong> Set cut-off value (in angstroms) for non-bonded interactions, default 12;</p></li>
<li><p><strong>maxcyc:</strong> Set total number of minimization steps, default 150;</p></li>
<li><p><strong>ncyc:</strong>  Set the initial number of steepest descent steps, default 100.</p></li>
</ul>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In most cases, the default parameters of 100 steps of steepest descent (<code class="docutils literal notranslate"><span class="pre">ncyc</span></code>) and 50 steps of conjugate gradient (total of 150 <code class="docutils literal notranslate"><span class="pre">maxcyc</span></code> steps) in vacuum conditions are sufficient to produce a correct result. Depending on the system, users can increase or decrease these values to have better results.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Always check both the original CG trajectory and the backmapping output to identify out-of-the-ordinary behavior and adjust arguments accordingly. Keep in mind that the minimized structures sometimes may differ from the CG trajectory due to the combination of all-atom minimization algorithms, number of cycles, cutoffs, etc.</p>
</div>
<p>The “Run Backmap” button will examine all the established parameters and execute the backmapping. The calculation can be stopped using the “Stop” button if something goes wrong.</p>
<p>The VMD output area will display the progress of the calculation. Upon completion of the calculation, the “Backmapping” folder is created in the working directory, containing the <code class="docutils literal notranslate"><span class="pre">backmap.pdb</span></code> file. If all went well, the “Open Backmap in VMD” button will be enabled and users should be able to launch VMD with the backmapped frames.</p>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, BA, SL, SM.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>